var lang="zh";var language={};var Hour=3600000;var Day1Milis=24*Hour;var enWeather="Unknown,PM Showers,PM Light Rain,Mostly Cloudy,Light Rain,Fair,Partly Cloudy,AM Thunderstorms,tornado,tropical storm,hurricane,severe thunderstorms,thunderstorms,mixed rain and snow,mixed rain and sleet,mixed snow and sleet,freezing drizzle,drizzle,freezing rain,showers,showers,snow flurries,light snow showers,blowing snow,snow,hail,sleet,dust,foggy,mist,haze,smoky,blustery,windy,cold,cloudy,mostly cloudy (night),mostly cloudy (day),partly cloudy (night),partly cloudy (day),clear (night),sunny,fair (night),fair (day),mixed rain and hail,hot,isolated thunderstorms,scattered thunderstorms,scattered thunderstorms,scattered showers,heavy snow,scattered snow showers,heavy snow,partly cloudy,thundershowers,snow showers,isolated thundershowers,mostly Sunny,not available";
var cnWeather="未知,下午阵雨,下午小雨,满云密布,小雨,转晴,局部多云,上午雷阵雨,龙卷风,热带风暴,飓风,强雷阵雨,雷阵雨,小雨加雪,雨加冰雹,雪加冰雹,冻毛毛雨,毛毛雨,冻雨,阵雨,阵雨,小雪,零星小雪,高吹雪,雪,冰雹,雨夹雪,尘,雾,薄雾,雾霾,多烟,大风,有风,寒冷,阴天,夜间阴天,白天阴天,夜间多云,白天多云,夜间清亮,晴朗,夜间转晴,白天转晴,雨夹冰雹,炎热,雷阵雨,雷阵雨,雷阵雨,阵雨,大雪,零星阵雪,大雪,多云,雷阵雨,阵雪,局部雷阵雨,晴时多云,暂无";var enDate="Mon,Tue,Wed,Thu,Fri,Sat,Sun";var cnDate="星期一,星期二,星期三,星期四,星期五,星期六,星期天";
language.zh={"payError_1":"支付记录插入失败，请刷新页面重试！","addSight":"增加景点","realBudget":"实时预算","agree_done":"您已经投过票了,谢谢.","actPingCheCustomer":"乘客求拼车","actPingCheOwner":"车主拼车","actPingChe":"拼车","actCityActivity":"活动","act_share":"旅行计划","act_recruit":"组团招募","act_common":"怎么玩","hCity1":"城市(不输入为全部)","hCity2":"所在城市","hCity3":"出发城市","hFrom1":"出发地","hTarget1":"想去的景点或目的地","hTarget2":"目的地","hTarget3":"到达城市","hTarget4":"您想讨论的话题或目的地...","Sun":"日","Mon":"一","Tue":"二","Wed":"三","Thu":"四","Fri":"五","Sat":"六","expand_room":"查看全部房型","collapse_room":"返回","booking_now":"立即预定  ","start_point":"出发地点(附近)","end_point":"目的地点(附近)","activity_point":"活动地点(附近)","PLEASE_FILL_ALL":"请填写所有的输入框.","ORDER_SUCCESS":'订购成功，请到"用户中心-我的购物",并完成支付.',"SELECT_PRODUCT_POST":"请选择邮寄方式","SELECT_PRODUCT_ATTRIBUTE":"请选择宝贝的[{0}]属性","man":"男","woman":"女","root":"管理员","rcSuccess":"退款成功","rcNoInstanceRecord":"数据库不存在该记录，请与管理员联系","rcNoRecruiting":"活动不在招募状态","rcAlreadyRefund":"已经退款","pcNoBillRecord":"数据库不存在该记录，请与管理员联系","rcNoBillMoneyMatch":"退款和对方清单的金额不一致","rcNoBillPayDepositMatch":"对方清单的定金状态不是支付状态","rcNoBillPayTotalMatch":"对方清单的全款状态不是支付状态","please_login":"请先登录!","psNeedPay":"需要马上支付","psPaid":"已经支付","psRefund":"已经退款","join_success":'加入成功，你可以进入"用户中心-我参加的活动"，管理您的活动.',"INPUT_PLEASE":"请输入 {0}","FROM_POINT":"起始地点","TO_POINT":"目的地点","search_geo_wait":"请稍候,正在搜索地标数据","search_geo_fail":"在GOOGLE-MAP没有找到{0}地标!","sorry_for_search":"对不起，没有找到数据","count_for_search":"总找到 {0}记录.","input_url":"请输入链接地址","cancel":"取消","reopen":"启用","ticket_air":"飞机票","ticket_train":"火车票","ticket_bus":"汽车票","ticket_ship":"轮船票","cost_hotel":"住宿","cost_sight":"门票","cost_eat":"餐饮","cost_common":"其他费用","cost_activity":"活动","cost_shop":"购物","cost_location":"地标","userName":"网名","email":"邮件地址","href":"链接地址","description":"描述说明","Bold":"黑体","Italic":"斜体","Underline":"下划线","FontSize":"字体大小","AddLink":"设置链接","RemoveLink":"取消链接","URL":"链接地址","Title":"标题","OpenIn":"打开方式","CurrentWindow":"在当前窗口","NewWindow":"在新窗口","ChangeTextColor":"字体颜色","submit":"提交","prev":"上一个","next":"下一个","item":"项","of":"/","ago":"以前","year":"年","month":"月","week":"星期","day":"天","hour":"小时","minute":"分钟","second":"秒","require":"请输入值..","millisecond":"毫秒","BUTTON_ADD":"增加","BUTTON_DELETE":"删除","BUTTON_CANCEL":"取消","BUTTON_CLOSE":"关闭","BUTTON_UPDATE":"提交","BUTTON_COLLAPSE":"收起","BUTTON_EXPAND":"展开","BUTTON_UPLOAD":"点击,上传图片","MESSAGE_CONFIRM":"您确定吗？","MESSAGE_NONE_GROUP":"未分组","MESSAGE_EMPTY":"数据为空","MESSAGE_REG_SUCCESS":"注册成功,请登录!","MESSAGE_UPLOADING":"上传中","MESSAGE_LOGIN_FAILURE":"登录失败，请检查你的账号!","MESSAGE_UPDATE_SUCCESS":"提交成功,更新成功.","MESSAGE_UPDATE_FAIL":"更新失败.","FILE_LIMIT_SIZE":"文件大小不能超过 %s","ERROR_ONLY_IMAGE":"只能上传图片","ERROR_UPLOAD_FAIL":"图片上传失败","ERROR_VERIFY_FAIL":"验证码校验错误","ERROR_DUP_IMAGE":"图片名称%s已经存在","ERROR_CHECK_MAP":"请检查%s是否正常(重新编辑并保存一次)","ERROR_EXIST":"该[%s]已经存在.","ERROR_CHECK_INPUT":"请检查您的输入.","LIMIT_INPUT_REMTEXT":"还可以输入%n字符","LIMIT_INPUT_TEXT":"","TEXTBOXLIST_WAIT":"稍候...","TEXTBOXLIST_TYPING":"","SAY_CLOSE_DIALOG":"关闭","SAY_FILES":"图片","SAY_FILE_URL":"链接地址","DEFAULT_GROUP_NAME":"缺省组","all":"全部","MESSAGE_SUGGESTION":"按“回车键”，确认输入.","validate_required":"*","validate_remote":"请修正该字段","validate_email":"请输入正确格式的电子邮件","validate_url":"请输入合法的网址","validate_date":"请输入合法的日期","validate_dateISO":"请输入合法的日期 (ISO).","validate_number":"请输入合法的数字","validate_digits":"只能输入整数","validate_creditcard":"请输入合法的信用卡号","validate_equalTo":"请再次输入相同的值","validate_accept":"请输入拥有合法后缀名的字符串","validate_maxlength":"请输入一个长度最多是 {0} 的字符串","validate_minlength":"请输入一个长度最少是 {0} 的字符串","validate_rangelength":"请输入一个长度介于 {0} 和 {1} 之间的字符串","validate_range":"请输入一个介于 {0} 和 {1} 之间的值","validate_max":"请输入一个最大为 {0} 的值","validate_min":"请输入一个最小为 {0} 的值","error_system":"系统错误{0}，请联系我们"};
__=function(arg){var msg_lang=eval("language."+lang);if(arg in msg_lang){return eval("msg_lang."+arg);}if(arg in language.en){return eval("language.en."+arg);}return'Warning: "'+arg+'" is not in dictionary, Please add it!';};function removeArray(a,d){var b=-1;for(var c=0;c<a.length;c++){if(a[c]==d){b=c;
break;}}if(b>=0){a.splice(b,1);}return a;}jQuery.cookie=function(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m.expires=-1;}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000));
}else{f=m.expires;}e="; expires="+f.toUTCString();}var l=m.path?"; path="+(m.path):"";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("");}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");
for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break;}}}return d;}};Date.prototype.fullDay=function(){var a=new Date(this.getFullYear(),0,1);return Math.ceil((this-a)/86400000)+1;};Date.prototype.addDay=function(a){return new Date(this.getTime()+a*24*60*60*1000);
};Date.addDay=function(a,c){if(typeof a=="string"){a=new Date(Date.parse(a.replace(/-/ig,"/")));}var b=new Date(a.getTime()+c*24*60*60*1000);return b.pattern("yyyy-MM-dd");};Date.prototype.pattern=function(a){var d={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};
var c={"0":"\u65e5","1":"\u4e00","2":"\u4e8c","3":"\u4e09","4":"\u56db","5":"\u4e94","6":"\u516d"};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));}if(/(E+)/.test(a)){a=a.replace(RegExp.$1,((RegExp.$1.length>1)?(RegExp.$1.length>2?"\u661f\u671f":"\u5468"):"")+c[this.getDay()+""]);
}for(var b in d){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(d[b]):(("00"+d[b]).substr((""+d[b]).length)));}}return a;};String.format=function(){if(arguments.length==0){return null;}var c=arguments[0];for(var a=1;a<arguments.length;a++){var b=new RegExp("\\{"+(a-1)+"\\}","gm");
c=c.replace(b,arguments[a]);}return c;};String.prototype.toDate=function(){if(this==null||this.length==0){return null;}var b;try{b=new Date(Date.parse(this.replace(/-/g,"/")));}catch(a){return null;}return b;};String.prototype.toTime=function(){var a=this.toDate();if(a==null){return 0;}return a.getTime();
};String.prototype.toInt=function(){if(this.length==0){return 0;}return parseInt(this);};String.prototype.isNumber=function(){var a="^[0-9]+$";var b=new RegExp(a);if(this.search(b)!=-1){return true;}else{return false;}};String.prototype.isInteger=function(){var a=/^[-]{0,1}[0-9]{1,}$/;return a.test(this);
};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"");};String.prototype.trimAll=function(){return this.replace(/^\s+|(\s*$)|\r\n|\ |\r|\n/g,"");};String.prototype.escape=function(){return this.replace(/\r\n|\r|\n/g,"<br/>").replace(/ /g,"&nbsp;");};String.prototype.unescape=function(){return this.replace(/<br[^>]*>/ig,"\n").replace(/&nbsp;/ig," ");
};String.prototype.startWith=function(b){var a=new RegExp("^"+b);return a.test(this);};String.prototype.endWith=function(b){var a=new RegExp(b+"$");return a.test(this);};String.prototype.strip=function(){var a=document.createElement("DIV");a.innerHTML=this;return a.textContent||a.innerText||"";};var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="";
var k,h,f,j,g,e,d;var b=0;c=Base64._utf8_encode(c);while(b<c.length){k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64;}else{if(isNaN(f)){d=64;}}a=a+this._keyStr.charAt(j)+this._keyStr.charAt(g)+this._keyStr.charAt(e)+this._keyStr.charAt(d);
}return a;},decode:function(c){var a="";var k,h,f;var j,g,e,d;var b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<c.length){j=this._keyStr.indexOf(c.charAt(b++));g=this._keyStr.indexOf(c.charAt(b++));e=this._keyStr.indexOf(c.charAt(b++));d=this._keyStr.indexOf(c.charAt(b++));k=(j<<2)|(g>>4);h=((g&15)<<4)|(e>>2);
f=((e&3)<<6)|d;a=a+String.fromCharCode(k);if(e!=64){a=a+String.fromCharCode(h);}if(d!=64){a=a+String.fromCharCode(f);}}a=Base64._utf8_decode(a);return a;},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d);
}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128);}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128);}}}return a;},_utf8_decode:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);
if(e<128){b+=String.fromCharCode(e);d++;}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2;}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3;}}}return b;}};function Hashtable(){this.items=new Array();
this.itemsCount=0;this.add=function(b,c){if(!this.containsKey(b)){this.itemsCount=this.itemsCount+1;}this.items[b]=c;};this.values=function(){return this.items;};this.get=function(b){if(this.containsKey(b)){return this.items[b];}else{return null;}};this.remove=function(b){if(this.containsKey(b)){var c=this.items[b];
this.itemsCount=this.itemsCount-1;delete c;return c;}return null;};this.containsKey=function(b){return typeof(this.items[b])!="undefined";};this.containsValue=function a(c){for(var b in this.items){if(this.items[b]==c){return true;}}return false;};this.contains=function(b){return this.containsKey(b)||this.containsValue(b);
};this.clear=function(){this.items=new Array();this.itemsCount=0;};this.size=function(){return this.itemsCount;};this.isEmpty=function(){return this.size()==0;};}var tokenInputs=new Hashtable();var stepByWeek=604800000;var stepByDay=86400000;var stepByHour=3600000;var pasteCount=0;var now=new Date();
var thismonth=now.getMonth();var thisyear=now.getFullYear();var thisday=now.getDay();var scrollOption=null;var pictures=null;var pictureCount=0;var callClosed=false;var callRate="";var callerLine=0;var calleeLine=0;var logicals=new Hashtable();var outsides=new Hashtable();var tip=null;var letters=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];
var calendar;var defaultCities=[{country:"法国",value:"巴黎",type:2},{country:"意大利",value:"罗马",type:2},{country:"韩国",value:"首尔",type:2},{country:"日本",value:"东京",type:2}];var defaultCountries=[{continent:"欧洲",value:"法国",type:1},{continent:"欧洲",value:"意大利",type:1},{continent:"欧洲",value:"英国",type:1},{continent:"北美洲",value:"美国",type:1},{continent:"亚洲",value:"韩国",type:1},{continent:"亚洲",value:"泰国",type:1}];
function findParentByTag(c,b){if(c.tagName.toLowerCase()==b){return c;}var a=c.parentNode;while(a&&a.tagName.toLowerCase()!=b){a=a.parentNode;}return a;}function findParentBy(d,b,c){if(d.getAttribute(b)==c){return d;}var a=d.parentNode;while(a&&a.getAttribute(b)!=c){a=a.parentNode;}return a;}function removeNode(a){$("#"+a).remove();
return false;}function moveNode(d,a){var c=document.getElementById(d);var b=document.getElementById(a);if(c==null||b==null){return;}c.parentNode.removeChild(c);b.appendChild(c);}function rand(a,b){return Math.ceil(Math.random()*(b-a)+a);}function valueBy(a){if($(a).attr("placeholder")&&$(a).attr("placeholder")==$(a).val()){return"";
}else{return $(a).val();}}function selectValue(c,b){if(b==undefined||b==null){return;}var a="#"+c+' option[value="'+b+'"]';$(a).attr("selected",true);}function selectIndex(b,a){b.get(0).selectedIndex=a;}function isEmpty(a){if(a==undefined||a==null){return true;}if(a.length==0){return true;}if(a=="null"||a=="Null"||a=="NULL"){return true;
}return false;}function isEmptyObject(b){if(b==undefined){return true;}for(var a in b){return false;}return true;}function changeLanguage(a){$("div[class='yuyan'] a").removeClass("yya");lang=$(a).attr("code");var b={};b.funcIndex=3;b.langName=lang;b.url=document.URL;$.ajax({type:"POST",url:"/user",dataType:"json",async:false,data:JSON.stringify(b),success:function(c){$("#LangBox").hide();
if(c.xeach==true){window.location.reload();}return false;}});}function changeCityName(b,a){var c={};c.funcIndex=6;c.cityName=b;$.ajax({type:"POST",url:"/user",dataType:"json",async:false,data:JSON.stringify(c),success:function(d){window.location="/"+a;}});}function includeCss(a){if(developMode){return"/css/"+a+".css";
}else{return"/styles/org.x."+a+".css?v="+cssVersion;}}function shotUrl(a){return"http://pic.yiqihi.com/"+a+shotSchema;}function webShotUrl(a){return"http://pic.yiqihi.com/"+a+webShotSchema;}function pictureUrl(a){return"http://p.yiqihi.com/"+a;}function faceUrl(a){return"http://face.yiqihi.com/"+a+".jpg";
}function initRichEditor(g,c,d,f){var b=c?"| image":"";var a=c?"fullscreen | code":"";var e=c?"autolink image link":"";tinymce.init({selector:g,content_css:includeCss("tinymce_content"),language:"zh_CN",menubar:false,height:d==undefined?"300":d,plugins:["visualblocks searchreplace fullscreen  paste textcolor "+e],init_instance_callback:f?f:null,toolbar:a+" undo redo | forecolor backcolor | bold italic  alignleft aligncenter alignright alignjustify  bullist numlist outdent indent "+b});
}function richEditorBy(a){if(a[0]=="#"){a=a.substring(1,a.length);}return tinymce.get(a);}function tokenInputBy(a){return tokenInputs.get(a);}function addOutside(a,b){var c=$(a);if(c.length==0){return;}if(outsides.containsKey(a)){return;}var d={};d.e=c;d.func=b;outsides.add(a,d);}function addLogical(d,b){var c=d.split(",");
for(i=0;i<c.length;i++){var a=c[i];var f=$(a);if(f.length==0){return;}if(b==undefined){b="该数据项不能为空，请输入.";}var g={};g.selector=a;g.tipInfo=b;if(f.attr("container")){g.container=f.attr("container");}g.type="string";if(f.hasClass("numeric")){g.type="numeric";}else{if(f.hasClass("rich")){g.type="rich";g.selector="label[for='"+a.replace("#","")+"']";
}else{if(f.hasClass("token")){g.type="token";g.selector="#token-input-"+a.replace("#","");}else{if(f[0].nodeName.toLowerCase()=="ul"){g.type="ul";}}}}if(f.attr("minValue")){g.minValue=parseInt(f.attr("minValue"));}if(f.attr("maxValue")){g.minValue=parseInt(f.attr("maxValue"));}logicals.add(a,g);}}function checkNumberInput(a){var c=$(a);
for(var d=0;d<c.length;d++){var f=$(c[d]);f.val(f.val().replace(/\D|^0/g,""));var b=f.val();if(b.length==0){b="0";f.val("0");}}}function checkLogical(a){var c=logicals.get(a);if(!c){return true;}var b="";switch(c.type){case"string":case"numeric":b=valueBy(a);break;case"rich":b=richEditorBy(a).getContent();
break;case"ul":b=$(a+" li").length.toString();break;case"token":b=tokenInputBy(a.replace("token-input-","")).getTokens().length.toString();break;}if(c.type=="string"||c.type=="rich"){if(b.length==0){showLogicalTip(c);return false;}return true;}var d=parseInt(b);if(isNaN(d)){showLogicalTip(c);return false;
}if(c.minValue&&parseInt(b)<c.minValue){showLogicalTip(c,"不能小于最小值"+c.minValue);return false;}else{if(c.maxValue&&parseInt(b)<c.maxValue){showLogicalTip(c,"不能大于最大值"+c.maxValue);return false;}}return true;}function checkLogicals(c){for(var b=0;b<c.length;b++){var a=logicals.get(c[b]);if(a!=null){return checkLogical(c[b]);
}if($(c[b]).val().length==0){return false;}}return true;}function showLogicalTip(a,b){var d=$(a.selector);$("html,body").scrollTop(d.offset().top-90);if(a.container){var f=$(a.container);if(f.css("display")=="none"){f.show();}}if(b){tip.popup(d,b);}else{tip.popup(d,a.tipInfo);}}function showTip(a,c){var b=logicals.get(a);
if(b==undefined||b==null){var d=$(a);if(d.length==0){return;}$("html,body").scrollTop(d.offset().top-90);if(c){tip.popup(d,c);}else{tip.popup(d,"请输入正确的数据.");}return;}showLogicalTip(b,c);}function calcSpendTime(e,d){var a=e.split(":");var j=d.split(":");var g=parseInt(a[0],10);var f=parseInt(j[0],10);
var n=parseInt(a[1],10);var l=parseInt(j[1],10);var c=0;if(f>g){c=f-g;}else{c=24-g+f;}var b=0;if(l>n){b=l-n;}else{b=60+l-n;c=c-1;}var k=c+b/60;return k.toFixed(1);}function currentDate(){var a=new Date();return a.pattern("yyyy-MM-dd");}function weekName(a){switch(a){case 0:return __("Sun");case 1:return __("Mon");
case 2:return __("Tue");case 3:return __("Wed");case 4:return __("Thu");case 5:return __("Fri");case 6:return __("Sat");}}function dayDiff(g,e){var c=strToDate(g);var a=strToDate(e);var b=a.getTime()-c.getTime();if(b<=0){return 0;}var f=Math.floor(b/stepByDay);return f;}function dateDiff(b){var j=currentDate.getTime()-b;
if(j<=0){return"";}var g=Math.round(j/(stepByWeek*50));if(g>=1){return g+__("year")+__("ago");}var c=Math.round(j/(stepByWeek*4));if(c>=1){return c+__("month")+__("ago");}var k=Math.round(j/stepByWeek);if(k>=1&&k<=4){return k+__("week")+__("ago");}var f=Math.round(j/stepByDay);if(f>=1&&f<=7){return f+__("day")+__("ago");
}var e=Math.round(j/stepByHour);if(e>=1&&e<=24){return e+__("hour")+__("ago");}var a=Math.round(j/60000);if(a>=1&&a<=60){return a+__("minute")+__("ago");}var l=Math.round(j/1000);if(l>=1&&l<=60){return l+__("second")+__("ago");}return j+__("millisecond")+__("ago");}function yearOf(b){var a=new Date(b);
return a.getFullYear();}function monthOf(b){var a=new Date(b);return a.getMonth()+1;}function dayOf(b){var a=new Date(b);return a.getDate();}function iff(a,d,c){if(a){return d;}return c;}function ifEmpty(b,a){if(b){return b;}return a;}function replaceLine(a){return a.replace(/\r/g,"<br>").replace(/\n/g,"<br>");
}function addHours(a){var b=new Date();return b.getTime()+(a*60*60*1000);}function dateStrToLong(a){var b=strToDate(a);if(b==null){return 0;}}function strToDate(a){if(a==null||a==""){return null;}var c;try{c=new Date(Date.parse(a.replace(/-/g,"/")));}catch(b){return null;}return c;}function longToDateStr(a){var b=new Date();
b.setTime(a);return b.pattern("yyyy-MM-dd");}function longToDateShortStr(a){var b=new Date();b.setTime(a);return b.pattern("MM-dd");}function longToTimeStr(a){var b=new Date();b.setTime(a);return b.pattern("MM-dd hh:mm");}function longToDateTimeStr(a){var b=new Date();b.setTime(a);return b.pattern("yyyy-MM-dd hh:mm");
}function formatDate(a){return a.pattern("yyyy-MM-dd hh:mm:ss");}function Minimum(e,d,g){var f;f=e;if(d<f){f=d;}if(g<f){f=g;}return f;}function randomInt(a){return parseInt(Math.random()*a,10);}function editDistance(o,l){var k=new Array();var a;var c;var g;var f;var e;var h;var b;a=o.length;c=l.length;
if(a==0){return c;}if(c==0){return a;}for(g=0;g<=a;g++){k[g]=new Array();k[g][0]=g;}for(f=0;f<=c;f++){k[0][f]=f;}for(g=1;g<=a;g++){e=o.charAt(g-1);for(f=1;f<=c;f++){h=l.charAt(f-1);if(e==h){b=0;}else{b=1;}k[g][f]=Minimum(k[g-1][f]+1,k[g][f-1]+1,k[g-1][f-1]+b);}}return k[a][c];}function updateSelectElement(g,b){var c=$(g+" option");
var f=new Hashtable();for(var d=0;d<c.length;d++){var h=c[d];var a=h.value;f.add(a,a);}var j=$(g);for(var d=0;d<b.length;d++){if(f.containsKey(b[d])){continue;}j.append("<option value='"+b[d]+"'>"+b[d]+"</option>");}}function removeObjectsBy(c,e,b){for(var a=0;a<c.length;a++){var d=c[a];if(d[e]==b){c.splice(a,1);
return;}}}function htmlToText(d,a){var c=document.createElement("div");c.innerHTML=d;var b;b=(c.textContent!=null)?c.textContent:c.innerText;c=null;if(a){b=abbreviate(b,a);}return b;}function abbreviate(b,a){if(b.length<a){return b;}return b.substring(0,a)+"...";}function splitTextByPos(d,c){var b=d.length;
var a=new Array();if(b>c){a.push(d.substring(0,c));d=d.substring(c,b).trim();if(d.length>0){a.push(d);}}else{a.push(d.substring(0,b));}return a;}function fromatLangToken(a){if(a=="all"&&lang=="zh"){return __("all");}return a;}function repeatImage(b,e,d){var a=parseInt(d);var c=repeatContent("<img src='"+e+"'/>",a);
if(c.length==0){return"";}return b+c;}function repeatContent(d,c){if(c==0){return"";}var a=new Array();var b=0;while(b<c){a.push(d);b=b+1;}return a.join("");}function renderPage(f,d,c,b,e,h){var a=$(f);if(d>=b){var g=getPageCount(b,d);a.pager({pagenumber:c,pagecount:g,pagesize:b,buttonClickCallback:e,firstLast:h&&h==true});
a.show();}else{a.hide();}}function getPageCount(b,a){var c=Math.floor(a/b);var d=a%b;c=c+(d>0?1:0);return c;}function getCookieId(){return $.cookie("cookieId");}function readCookie(a){if(a==true){return $.cookie("cookieId");}else{return $("#header").attr("cookieId");}}function doLogout(){$.ajax({type:"POST",url:"/user",dataType:"json",data:"{'funcIndex':5}",success:function(a){if(a.xeach==true){window.location="/";
}}});}function logout(a){doLogout();}function follow(c,a,b){if(checkLogin()==false){return false;}$.ajax({type:"POST",url:"/user",dataType:"json",data:"{'funcIndex':21,'userId':"+a+",'userName':'"+b+"'}",success:function(d){if(d.xeach==true){$(c).html("<span class='tick'></span>已关注");}}});}function preloadPicture(d,b,c,e){var a=$(new Image());
a.attr("src",e);$("#preloading").show();a.load(function(){centerPicture(d,b,c,e,this.width,this.height);}).error(function(){centerPicture(d,b,c,e,this.width,this.height);});}function centerPicture(f,l,e,a,k,d){$("#preloading").hide();if(d>e){var g=k/d;d=e;k=e*g;}if(k>l){var g=d/k;k=l;d=l*g;}$(f).attr("src",a);
$(f).attr("width",k);$(f).attr("height",d);var b=$(f).parent();b.css("top","0px");if(d<e){var j=e-d;b.css("top",(j/2)+"px");}b.css("left","0px");if(k<l){var j=l-k;var c=j/2;b.css("left",c+"px");}}function popup(b,f,e){var a;$(b).css("position","absolute");if(f==null){e.name="screen-center";}switch(e.name){case"left-align":a=$(f).position();
$(b).css("top",(a.top+e.y+$(f).height()+5)+"px");$(b).css("left",a.left+e.x+"px");break;case"right-align":a=$(f).position();$(b).css("top",(a.top+e.y+$(f).height()+5)+"px");$(b).css("left",(a.left-$(b).width())+e.x+"px");break;case"screen-center":var d=($(window).height()-$(b).height())/2+$(window).scrollTop()-30;
var c=($(window).width()-$(b).width())/2+$(window).scrollLeft();$(b).css("left",c+"px");$(b).css("top",d+"px");break;}$(b).show();return false;}function addLoading(a){var b=$(a).find("img[class='loading']");if(b.length>=1){return;}$(a).append('<img class="loading" src="/images/loader-button.gif"/>');
}function removeLoading(a){$(a).find("img[class='loading']").each(function(c,b){$(b).remove();});}function showLoading(a){var b=$(a).find("img[class='loading']");if(b.length>=1){return;}$(a).append('<img class="loading" src="/images/spinner.gif"/>');}function hideLoading(a){$(a).find("img[class='loading']").each(function(c,b){$(b).remove();
});}function showProcess(a){var b=$(a).next("img[class='process']");if(b.length>=1){return;}$('<img class="process" src="/images/process.gif"/>').insertAfter($(a));}function hideProcess(a){$(a).nextAll("img[class='process']").each(function(c,b){$(b).remove();});}function showLangBox(a,b){popup("#LangBox",a,"left-align");
}function translate(a){$(a).each(function(b,c){var f=$(c);var g=f.attr("fromLang");if(g==undefined||g==null){return false;}var d=f.attr("toLang");if(d==undefined||d==null){return false;}if(g==d){return false;}return f.translateTextNodes(g,d,{});});}function hasPlayerVersion(c){var b=swfobject.getFlashPlayerVersion();
var a=c.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return(b.major>a[0]||(b.major==a[0]&&b.minor>a[1])||(b.major==a[0]&&b.minor==a[1]&&b.release>=a[2]))?true:false;}function loadFlash(d,b,c,k,e,f,j,h){var a="10.0.0";var g="playerProductInstall.swf";if(hasPlayerVersion(a)){f.wmode="opaque";
swfobject.embedSWF(d,b,c,k,a,g,e,f,j,h);}else{f.quality="high";if(!f.bgColor){f.bgcolor="#ffffff";}a="9.0.0";swfobject.embedSWF("/map/playerProductInstall.swf",b,c,k,a,g,e,f,j);}}function checkBudgetEnabled(a){if(a==2||a==3||a==4||a==13||a==30){return true;}return false;}function checkBudgetEditable(a){if(a==2||a==3||a==4){return false;
}return true;}function getBudgetHrefTitle(a){switch(a){case 30:return __("addSight");default:return __("realBudget");}}function getOrderStateName(a){if(a>=13){return"异常";}switch(a){case 8:return"支付成功";case 9:return"订单成行";case 10:return"行程中";case 11:return"行程结束";case 12:return"行程纠纷";default:return"未支付";
}}function getChargeWayName(a){switch(a){case 0:return"每小时";case 1:return"每天(8小时)";case 2:return"每天(10小时)";case 3:return"每次";case 5:return"每人";case 6:return"每个";default:return"每天";}}function getMapActivityTitle(a){switch(a){case"1":return __("act_share");case"2":return __("act_recruit");default:return __("act_common");
}}function getCityActivityTitle(b,a){switch(parseInt(b)){case 3:switch(parseInt(a)){case 1:return __("actPingCheCustomer");case 2:return __("actPingCheOwner");default:return __("actPingChe");}default:return __("actCityActivity");}}function getSexTitle(a){if(a==1){return __("man");}else{if(a==0){return __("woman");
}else{if(a==2){return"保密";}}}}function getPayStateTitle(a){switch(a){case 0:return __("psNoSupport");case 1:return __("psNoRecord");case 2:return __("psFail");case 3:return __("psExpiredFail");case 4:return __("psPending");case 5:return __("psAccountAbnormal");case 6:return __("psNoMoney");case 7:return __("psSuccess");
}}function leaseTypeBy(a){if(a=="house"){return"整租";}else{if(a=="apartment"){return"单间出租";}else{if(a=="mcmansions"){return"床位出租";}}}}function lodgeTypeBy(a){if(a=="house"){return"民房";}else{if(a=="apartment"){return"公寓";}else{if(a=="mcmansions"){return"独栋别墅";}else{if(a=="hotel"){return"便捷酒店/旅馆";}else{if(a=="tavern"){return"客栈";
}else{if(a=="loft"){return"阁楼";}else{if(a=="courtyard"){return"四合院";}else{if(a=="seasidecottage"){return"海边小屋";}else{if(a=="dormitory"){return"集体宿舍";}else{if(a=="woodscottage"){return"林间小屋";}else{if(a=="luxuryhouse"){return"豪宅";}else{if(a=="castle"){return"城堡";}else{if(a=="treehouse"){return"树屋";}else{if(a=="cabin"){return"船舱";
}else{if(a=="carhouse"){return"房车";}else{if(a=="icehouse"){return"冰屋";}else{return"普通住宅";}}}}}}}}}}}}}}}}}function bedTypeBy(a){if(a=="double-max"){return"双人床（大）";}else{if(a=="double-med"){return"双人床（中）";}else{if(a=="double-small"){return"双人床（小）";}else{if(a=="single"){return"单人床";}else{if(a=="canopy"){return"架子床";
}else{if(a=="sofa"){return"沙发床";}else{if(a=="tatami"){return"榻榻米";}else{if(a=="airbed"){return"气垫床";}else{if(a=="waterbed"){return"水床";}else{if(a=="sexbed"){return"性爱床";}}}}}}}}}}}function toiletTypeBy(a){if(a=="0"){return"共有卫生间";}else{if(a=="1"){return"独立卫生间";}else{return"";}}}function bizWord(c,a){var b=[];
b.push("<em class='");switch(c){case 5:b.push("pinkbk'>");b.push("车");case 6:if(a==0){b.push("redbk'>");b.push("导");}else{b.push("yellowbk'>");b.push("线");}case 0:b.push("bluebk'>");b.push("说");case 10:b.push("grnbk'>");b.push("询");}b.push("</em>");return b.join("");}function bizTypeNameBy(a){switch(a){case 5:return"车辆出租";
case 6:return"导游地陪";case 7:return"客栈别墅";}}function bizPageNameBy(b,a){switch(b){case 5:return"car";case 6:if(a==0){return"guide";}else{return"trip";}case 7:return"room";}}function orderStateNameBy(a){switch(a){case 0:return"待审核";case 1:return"逾期自动取消";case 2:return"客人取消交易";case 3:return"发布主拒绝";case 4:return"发布主接受";
case 5:return"客人违约取消交易";case 6:return"发布主接受违约";case 7:return"交易完成";case 8:return"<font color='#CC2A42'>拒绝支付,交易纠纷</font>";}}function fieldBy(c,d){var a;if(typeof(c)=="string"){var b=JSON.parse(c);a=b[d];}else{a=c[d];}if(a){return a;}return"";}function popupManage(b,a){$("#manageObject").text(JSON.stringify(a));
popup("#manageWindow",b,{"name":"left-align","x":0,"y":0});if(a.param1){$("#manageParam1").val(a.param1);}if(a.param2){$("#manageParam2").val(a.param2);}if(a.param3){$("#manageParam3").val(a.param3);}if(a.param4){$("#manageParam4").val(a.param4);}}function renderRules(c){if(c.rules==undefined||c.rules.length==0){$("#rules").html("");
return;}var b=new JsEvalContext(c);var a=document.getElementById("rules");var d=jstGetTemplate("templateRules");a.innerHTML="";a.appendChild(d);jstProcess(b,a);}function readRuleContent(d,a){var e=[];e.push("预订日期从<span class='date'>"+longToDateStr(a.from)+"</span>至<span class='date'>"+longToDateStr(a.to)+"</span>期间：");
var b="";switch(a.key){case"person":e.push("如果预订客人数");b="每个客人";break;case"hour":e.push("如果预订小时数");b="每个小时";break;case"day":e.push("如果预订天数");b="每天";break;case"room":e.push("如果预订房间数");b="每个房间";break;}e.push("大于等于"+a.value+",");e.push("按照<span>"+b+"</span>");return e.join("");}function readRuleAmount(a){var b=[];
if(a.day<0){b.push("每个旅客<br>");}else{if(a.bizTyp==7){b.push("每间每天<br>");}else{if(a.bizType==8){b.push("每床位每晚<br>");}}}if(a.operate==0){b.push("<font color='green'>优惠</font><span class='pm'>"+getCurrencyName(a.currency)+a.amount+"</span>");}else{b.push("<font color='red'>加价</font><span class='pm'>"+getCurrencyName(a.currency)+Math.abs(a.amount)+"</span>");
}return b.join("");}function readRowclass(a){if(a%2==0){return"";}return"even";}function readCalcPriceObject(h,d,a,g,e,k,c,b,f){var j={};j.funcIndex=1;j.bizType=h;j.shortId=d;j.catalog=g;j.bizName=a;j.from=k;j.personCount=b;if(e==0){j.hour=c;}else{j.day=c;}if(f){j.roomCount=f;}return j;}function calcPrice(b,c){c.isDebug=false;
showLoading(b);var a=0;$.ajax({type:"POST",url:"/calendar",dataType:"json",async:false,data:JSON.stringify(c),success:function(d){hideLoading(b);if(d.xeach==false){showInfo(d.message);return false;}a=d.total;}});return a;}function readMessageClass(a){if(a%2==0){return"odd pending";}else{return"even pending";
}}function readMessageTagClass(a){if(a.readTag==1){return"";}else{return"violet";}}function authClassByState(a){if(a!=2){return"authno";}return"authyes";}function readMessageTitle(a){var b=[];b.push(a.fromUserName);b.push('<em style="display:inline-block;margin-left:6px;">');b.push(longToDateTimeStr(a.timestamp));
b.push("</em>");switch(a.action){case 0:b.push('<label class="badge pendding">预约,等待回复</label>');break;case 1:b.push('<label class="badge pendding">预约,交流中</label>');break;case 2:b.push('<label class="badge accept">接受预约</label>');break;case 3:b.push('<label class="badge deny">拒绝预约</label>');break;case 4:b.push('<label class="badge accept">接受预约,特别优惠</label>');
break;case 6:b.push('<label class="badge notification">系统通知</label>');break;}return b.join("");}function readMessageLink(a){var b=[];switch(a.bizType){case 0:break;case 1:break;case 2:break;case 3:break;case 4:break;case 5:case 6:case 7:b.push('<a class="link underline" href="/message/'+a.keyId+"&m="+a.msgId+'">'+a.title+"</a>");
break;case 8:b.push('<a class="link underline" href="/order/'+a.keyId+"&m="+a._id.$oid+'">'+a.title+"</a>");break;case 9:b.push('<a class="link underline" href="/finance/'+a._id.$oid+'">'+a.title+"</a>");break;}return b.join("");}function readStar(b){var d=[];d.push("<em class='rating'>");for(var a=1;
a<=5;a++){if(b>=a){d.push("<em class='star selected'></em>");}else{d.push("<em class='star'></em>");}}d.push("</em>");return d.join("");}function changeImage(c,a){if(c==undefined){return;}var b=new Date().getTime();if(a){c.src="/captcha.jpg?d="+b+"&clientKey="+a;}else{c.src="/captcha.jpg?d="+b;}}function showOk(a){$.alert.open("info","信息提示",a);
}function showFail(a){$.alert.open("error","错误提示",a);}function showInfo(a){$.alert.open("info","信息提示",a);}function selectCities(b,a){return $(b).autocomplete({url:"/lookup",extraParams:{funcIndex:2},data:defaultCities,showResult:function(d,c){return"<span>"+d+"</span><em>"+c.country+"</em>";},displayValue:function(d,c){return c.value;
},onItemSelect:function(d,c){if(d){c.dom.$elem.attr("country",d.country);}if(a){a(d);}},mustMatch:false,selectFirst:true,selectOnly:false,remoteDataType:"json"});}function selectCountries(b,a){return $(b).autocomplete({url:"/lookup",extraParams:{funcIndex:1},offset:a,data:defaultCountries,showResult:function(d,c){return"<span>"+d+"</span><em>"+c.continent+"</em>";
},displayValue:function(d,c){return c.value;},mustMatch:false,selectFirst:true,selectOnly:false,remoteDataType:"json"});}function selectLocations(b,a){return $(b).autocomplete({url:"/lookup",extraParams:{funcIndex:5},data:defaultCountries,showResult:function(d,c){switch(c.type){case 1:return"<span>"+d+"</span><em>"+c.continent+"</em>";
case 2:return"<span>"+d+"</span><em>"+c.country+"</em>";default:return"<span>"+d+"</span>";}},displayValue:function(d,c){return c.value;},onItemSelect:function(d,c){c.dom.$elem.attr("t",d.type);switch(d.type){case 1:c.dom.$elem.attr("contient",d.contient);break;case 2:c.dom.$elem.attr("country",d.country);
break;}if(a){a(c.dom.$elem.get(0));}},mustMatch:false,selectFirst:true,selectOnly:false,remoteDataType:"json"});}function inputCities(e,d,c){var b="/lookup?funcIndex=";if(c){b+=c;}else{b+="2";}if(d){b+="&country="+d;}var a=$(e).tokenInput(b,{method:"POST",propertyToSearch:"value",hintText:"输入全拼或简拼↑↓选择",noResultsText:"没有搜索到任何数据",searchingText:"正在搜索..",theme:"facebook",animateDropdown:false,preventDuplicates:true,tokenValue:"value",allowFreeTagging:true,resultsFormatter:function(f){return"<li>"+f.value+"<span style='float:right'>"+f.country+"</span></li>";
},tokenFormatter:function(f){return"<li>"+f.value+"</li>";}}).data("tokenInputObject");tokenInputs.add(e,a);}function checkLogin(){if(currentUserId==0){dlgLogin.popup();return false;}return true;}function isLogined(){if(parseInt($("#header").attr("userId"))==0){alert("您没有登录,请登录!");return false;}return true;
}function isClientLogined(){if(isLogined()==false){return false;}return true;}function obj2str(c){var b=[];if(typeof c=="string"){return'"'+c.replace(/([\'\"\\])/g,"\\$1").replace(/(\n)/g,"\\n").replace(/(\r)/g,"\\r").replace(/(\t)/g,"\\t")+'"';}if(typeof c=="object"){if(!c.sort){for(var a in c){b.push('"'+a+'":'+obj2str(c[a]));
}if(!!document.all&&!/^\n?function\s*toString\(\)\s*\{\n?\s*\[native code\]\n?\s*\}\n?\s*$/.test(c.toString)){b.push("toString:"+c.toString.toString());}b="{"+b.join()+"}";}else{for(var a=0;a<c.length;a++){b.push(obj2str(c[a]));}b="["+b.join()+"]";}return b;}return c.toString();}function addWxContact(a){if(typeof WeixinJSBridge=="undefined"){return false;
}WeixinJSBridge.invoke("addContact",{webtype:"1",username:a},function(b){WeixinJSBridge.log(b.err_msg);});}function getCurrencyName(a){switch(a){case 1:return"€";case 2:return"$";case 3:return"£";case 4:return"円";case 5:return"₩";case 6:return"฿";case 7:return"C";case 8:return"A＄";case 9:return"S$";case 10:return"RM";
case 11:return"C$";case 12:return"N$";case 13:return"NT$";default:return"￥";}}function getCurrencyLabel(a){switch(a){case 1:return"欧元";case 2:return"美元";case 3:return"英镑";case 4:return"日元";case 5:return"韩币";case 6:return"泰铢";case 7:return"泰铢";case 8:return"澳币";case 9:return"新币";case 10:return"令吉";case 11:return"加元";
case 12:return"新西兰币";case 13:return"台币";default:return"人民币";}}function getCurrencyRate(b){var a=currencyRates.get(b);if(!a){return 1;}return a;}

var requests=new Hashtable();var pageName="";var currentUserId=0;var currentUserName="";var currentUserServer=null;var currentDate;var documentLoading=true;var cookieId=null;var openId=null;var isSpider=false;var isMobile=false;var isWeixinBrowser=false;var headTimer=0;var currentHeaderE=null;var dlgLogin;
var currentWebSocketUri=null;var multiCurrency=false;jQuery(document).ready(function(){initNav();parseRequestUrl();initHeader();if(typeof(documentReady)=="function"){documentReady();}initNumericInput();initFooter();refreshByCurrency();documentLoading=false;checkIE();});function checkIE(){var a=false;
if(navigator.userAgent.indexOf("MSIE 6.0")>0||navigator.userAgent.indexOf("MSIE 7.0")>0||navigator.userAgent.indexOf("MSIE 8.0")>0||navigator.userAgent.indexOf("MSIE 9.0")>0){a=true;}if(!a){return false;}$.smallBox({title:"强烈建议",content:"为了更好的使用体验，我们使用了H5技术，您的IE浏览器不支持该技术，建议您使用谷歌chrome、火狐firefox、苹果safari等浏览器，如果您使用的是360浏览器、搜狐浏览器，请切换到极速或高速模式....",icon:"http://img.yiqihi.com/icon_light.png",color:"#fffbd1"});
return true;}function initNumericInput(){$(".numeric").keyup(function(){checkNumberInput(this);}).bind("paste",function(){checkNumberInput(this);}).css("ime-mode","disabled");}function initHeader(){currentUserId=parseFloat($("#header").attr("userId"));currentUserName=$("#header").attr("userName");currentDate=new Date(parseFloat($("#header").attr("time")));
currentUserServer=$("#header").attr("userServer");currentWebSocketUri="ws://"+window.location.host+":"+webSocketPort+"/"+currentUserServer;cookieId=$("#header").attr("cookieId");openId=$("#header").attr("openId");isSpider=$("#header").attr("isSpider")=="true";isMobile=$("#header").attr("device")=="mobile";
cssVersion=$("#header").attr("cssVersion");var a=window.navigator.userAgent.toLowerCase();isWeixinBrowser=a.match(/MicroMessenger/i)=="micromessenger";if(currentUserId!=0){initHeaderUser();}if(!window.console){window.console={log:function(){}};}}function initFooter(){if(currentUserId==0){dlgLogin=new $.LoginDialog();
dlgLogin.init();}if($("#item-foot").length==0){return;}initScroll();$("#hide .hide-box").click(function(){$("#hide").animate({"right":"0"},500,function(){$("#show").animate({"right":"-100%"},300);});});$(document.body).bind("click",function a(d){var b=new Array();for(var c in outsides.items){var f=outsides.get(c);
if(f.e.css("display")=="none"){continue;}if(!$(d.target).closest(f.e[0]).length){b.push(c);f.func.apply(f.e,[f.e]);}}for(var c in b){outsides.remove(c);}});tip=$(document.body).poshytip({}).data("tip");}function subscribe(a){if(valueBy("#subscribeMail").length==0){showTip("#subscribeMail","请输入邮箱地址,然后点击订阅");
return false;}var b={};b.mail=$("#subscribeMail").val();b.state=a;b.funcIndex=1;$.ajax({type:"POST",url:"/recommend",dataType:"json",data:JSON.stringify(b),success:function(c){if(c.xeach==false){showFail(c.message);return;}showOk("操作成功。");return false;}});}function showNavPanel(a){if(currentHeaderE!=a){return;
}$("div[class^='nav_list']").hide();$("#_"+a.attr("id")).show();}function initScollMenu(a){$(a).each(function(){var g=$(this),c=g.find(".new_service_lists"),e=c.find("li"),j=g.find(".new_service_left"),f=g.find(".new_service_right"),b=e.length,k=5,i=e.width(),d=false,h=0;f.bind("click",function(){if(!d){d=true;
if(++h>b-k){h=b-k;d=false;}else{c.stop(true,false).animate({left:-i*h},function(){d=false;});}}});j.bind("click",function(){if(!d){d=true;if(--h<0){h=0;d=false;}else{c.stop(true,false).animate({left:-i*h},function(){d=false;});}}});});}function hideNavPanel(){$("div[class^='nav_list']").slideUp(300);
$("div[class='nav'] a").removeClass("selected");currentHeaderE=null;}function initNav(){initScollMenu("#_navS");$("#navBar").mouseleave(function(){hideNavPanel();});$("#navBar ul[class='service-hd'] li").mouseenter(function(a){var b=$(this);currentHeaderE=b;if(headTimer!=0){window.clearTimeout(headTimer);
}headTimer=window.setTimeout(function(){showNavPanel(b);},100);}).mouseleave(function(){currentHeaderE=null;});$("#_navG dl p[class='expand']").click(function(){var a=$(this).parent().parent();if(!a.hasClass("select")){$("#_navG dl").hide();a.show();a.addClass("select");}else{$("#_navG dl").show();a.removeClass("select");
}});$("#_navG dl").mouseover(function(){$(this).find("p[class='expand']").show();}).mouseout(function(){$(this).find("p[class='expand']").hide();});}function initHeaderUser(){$("div[class='logout'] li").click(function(a){var b=$(a.currentTarget).attr("class");if(b=="user"){$("#headUser").show();addOutside("#headUser",function(){$("#headUser").fadeOut();
});}else{$("#headUser").hide();outsides.remove("#headUser");}a.stopPropagation();});}function parseRequestUrl(){var c=document.createElement("a");c.href=document.URL;var d=c.pathname.replace(/^\//,"").split("/");pageName=d[0];if(d.length==1){return;}d=d[1].replace(/^\?/,"").split("&");var b=d.length,e=0,f;
for(;e<b;e++){if(!d[e]){continue;}f=d[e].split("=");requests.add(f[0],decodeURIComponent(f[1]));}}function checkFlashVersion(){var a=swfobject.getFlashPlayerVersion();var b=[];if(!hasPlayerVersion("10.0.0")){b.push("<font color='#ff2900'>");}else{b.push("<font color='green'>");}b.push(a.major+"."+a.minor+"."+a.release);
b.push("</font>");$("#flashVersion").html(b.join(""));}function popupLangBox(a){popup("#LangBox",a,{"name":"right-align","x":0,"y":0});}function changeLang(a){$("div[class='yuyan'] a").removeClass("yya");$("#lang"+a).addClass("yya");lang=$("#lang"+a).attr("code");$.ajax({type:"POST",url:"/user",dataType:"json",data:"{'mode':3,'langName':'"+lang+"','url':'"+document.URL+"'}",success:function(b){if(b.xeach==true){window.location.reload();
}return false;}});}function searchByHead(){if(valueBy("#edtHeadCountry").length==0){showTip("#edtHeadCountry","请输入您要去的国家");return false;}var a=[];a.push("c="+encodeURIComponent(valueBy("#edtHeadCountry")));var b=$("#headBizName").attr("value")+"/"+a.join("&");window.location=b;}function selectCurrency(){if($.cookie("currency")=="￥"){$.cookie("currency","");
}else{$.cookie("currency","￥");}window.location.reload();}function refreshByCurrency(){multiCurrency=$.cookie("currency")==null||$.cookie("currency")=="";if(multiCurrency){$("#selectCurrency").text("启动人民币");return;}else{$("#selectCurrency").text("启动多货币");}switch(pageName){case"":var a=$("span[class='guide_price']");
for(var b=0;b<a.length;b++){var d=$(a[b]);var c=calcRateAmount(d.text());d.text(c.key+c.value);}a=$("span[class='price-normal']");for(var b=0;b<a.length;b++){var d=$(a[b]);var c=calcRateAmount(d.text());d.text(c.key+c.value);}break;case"guide":case"car":case"trip":var a=$("span[class='price']");for(var b=0;
b<a.length;b++){var d=$(a[b]);var c=calcRateAmount(d.text());d.text(c.key+c.value);}var a=$("#edtPriceName span[class='fr']");for(var b=0;b<a.length;b++){var d=$(a[b]);var c=calcRateAmount(d.text());d.text(c.key+c.value);}var a=$("em[class='png']");for(var b=0;b<a.length;b++){var d=$(a[b]);var c=calcRateAmount(d.text());
d.html(c.key+c.value);}var a=$("p[class='price-info']");for(var b=0;b<a.length;b++){var d=$(a[b]);var c=calcRateAmount(d.text());d.html(c.key+c.value);}var a=$("div[class='product-box'] li span");for(var b=0;b<a.length;b++){var d=$(a[b]);var c=calcRateAmount(d.text());d.html(c.key+c.value);}break;case"searchtrip":var a=$("div[class='product-price']");
for(var b=0;b<a.length;b++){var d=$(a[b]);var c=calcRateAmount(d.text());d.html("<i>"+c.key+"</i><span>"+c.value+"</span>");}break;}}function calcRateAmount(d){d=d.trim();var c=d.replace(/[^0-9]/ig,"");var b=d.replace(c,"").trim();var a={};a.key=$.cookie("currency");a.value=Math.round(parseInt(c)/getCurrencyRate(b));
return a;}function initScroll(){if($.cookie("op_1st")==null){$.cookie("op_1st",true,{expires:300,path:"/"});$("#show").css("right","-100%");$("#hide").css("right","0");}else{$("#show").css("right","0");$("#hide").css("right","-128");}$("#hide .hide-box").click(function(){$("#hide").animate({"right":"0"},500,function(){$("#show").animate({"right":"-100%"},300);
});});$("#show em").click(function(){$("#show").animate({"right":"0"},300,function(){$("#hide").animate({"right":"-128px"},500);});$.cookie("op_1st",false,{expires:7,path:"/"});});var b=$("#item-foot").offset().top-55;var a=$(window).height();$(window).bind("scroll",function(){var c=$(document).scrollTop();
if(c>b-a||c<400){$("#bottomScoll").fadeOut();}else{$("#bottomScoll").fadeIn();}if(typeof(windowScroll)=="function"){windowScroll(c,BTop);}});}

var MAPS_DEBUG=false;function log(a){}var STRING_empty="";var CSS_display="display";var CSS_position="position";var TYPE_boolean="boolean";var TYPE_number="number";var TYPE_object="object";var TYPE_string="string";var TYPE_function="function";var TYPE_undefined="undefined";function jsEval(expr){try{return eval("["+expr+"][0]");
}catch(e){log("EVAL FAILED "+expr+": "+e);return null;}}function jsLength(a){return a.length;}function assert(a){}function copyProperties(c,b){for(var a in b){c[a]=b[a];}}function getDefaultObject(b,a){if(typeof b!=TYPE_undefined&&b!=null){return(b);}else{return a;}}function isArray(a){return a!=null&&typeof a==TYPE_object&&typeof a.length==TYPE_number;
}function arraySlice(c,b,a){return Function.prototype.call.apply(Array.prototype.slice,arguments);}function parseInt10(a){return parseInt(a,10);}function arrayClear(a){a.length=0;}function bindFully(b,d,c){var a=arraySlice(arguments,2);return function(){return d.apply(b,a);};}var DOM_ELEMENT_NODE=1;var DOM_ATTRIBUTE_NODE=2;
var DOM_TEXT_NODE=3;var DOM_CDATA_SECTION_NODE=4;var DOM_ENTITY_REFERENCE_NODE=5;var DOM_ENTITY_NODE=6;var DOM_PROCESSING_INSTRUCTION_NODE=7;var DOM_COMMENT_NODE=8;var DOM_DOCUMENT_NODE=9;var DOM_DOCUMENT_TYPE_NODE=10;var DOM_DOCUMENT_FRAGMENT_NODE=11;var DOM_NOTATION_NODE=12;function domGetElementById(a,b){return a.getElementById(b);
}function domCreateElement(b,a){return b.createElement(a);}function domTraverseElements(b,c){var a=new DomTraverser(c);a.run(b);}function DomTraverser(a){this.callback_=a;}DomTraverser.prototype.run=function(a){var b=this;b.queue_=[a];while(jsLength(b.queue_)){b.process_(b.queue_.shift());}};DomTraverser.prototype.process_=function(b){var a=this;
a.callback_(b);for(var d=b.firstChild;d;d=d.nextSibling){if(d.nodeType==DOM_ELEMENT_NODE){a.queue_.push(d);}}};function domGetAttribute(b,a){return b.getAttribute(a);}function domSetAttribute(b,a,c){b.setAttribute(a,c);}function domRemoveAttribute(b,a){b.removeAttribute(a);}function domCloneNode(a){return a.cloneNode(true);
}function domCloneElement(a){return(domCloneNode(a));}function ownerDocument(a){if(!a){return document;}else{if(a.nodeType==DOM_DOCUMENT_NODE){return(a);}else{return a.ownerDocument||document;}}}function domCreateTextNode(a,b){return a.createTextNode(b);}function domAppendChild(a,b){return a.appendChild(b);
}function displayDefault(a){a.style[CSS_display]="";}function displayNone(a){a.style[CSS_display]="none";}function positionAbsolute(a){a.style[CSS_position]="absolute";}function domInsertBefore(a,b){return b.parentNode.insertBefore(a,b);}function domReplaceChild(a,b){return b.parentNode.replaceChild(a,b);
}function domRemoveNode(a){return domRemoveChild(a.parentNode,a);}function domRemoveChild(a,b){return a.removeChild(b);}function stringTrim(a){return stringTrimRight(stringTrimLeft(a));}function stringTrimLeft(a){return a.replace(/^\s+/,"");}function stringTrimRight(a){return a.replace(/\s+$/,"");}

if(!this.JSON){this.JSON={};}(function(){function f(n){return n<10?"0"+n:n;}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null;
};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;
function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];
if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key);}if(typeof rep==="function"){value=rep.call(holder,key,value);}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);
case"object":if(!value){return"null";}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null";}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";
gap=mind;return v;}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v);
}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v;}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" ";}}else{if(typeof space==="string"){indent=space;
}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify");}return str("",{"":value});};}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];
if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}return reviver.call(holder,key,value);}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);
});}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j;}throw new SyntaxError("JSON.parse");
};}}());

var dlgPicture;var activity;var userPortal;$.UserPortal=function(){var a=this;this.initUserHeader=function(){$("#btnCover").click(function(b){$("#boxCover").show();addOutside("#boxCover",function(){$("#boxCover").fadeOut();});b.stopPropagation();});$("#btnQuestion").click(function(b){$("#boxQuestion").show();
addOutside("#boxQuestion",function(){$("#boxQuestion").fadeOut();});b.stopPropagation();});addLogical("#edtQTitle");addLogical("#edtQContent");$("#edtQTitle").watermark({onEnter:function(){$("#edtQContent").focus();}});$("#edtQContent").watermark({});$("#btnQ").click(function(b){a.postQuestion();});};
this.initUserMenu=function(){$("div[class='menu'] dd").click(function(h){var f=$(h.currentTarget);$("div[class='menu'] dd").removeClass("current");f.addClass("current");var g=f.find("a");window.location=g.attr("href");});var d=pageName;if(d=="postguide"||d=="postcar"){d="offers";}else{if(d=="postreq"){d="requires";
}}var c=$("div[class='menu'] a[href='/"+d+"']");if(c.length>0){var b=c.parent();b.addClass("current");}var e=$("div[class='profile']");$("html,body").scrollTop(e.offset().top-130);};this.initUserPanel=function(){a.initUserHeader();a.initUserMenu();};this.postQuestion=function(){if(checkLogicals(["#edtQTitle","#edtQContent"])==false){return;
}oReq={};oReq.funcIndex=9;oReq.title=$("#edtQTitle").val();oReq.content=$("#edtQContent").text();addLoading($("#btnQ"));$.ajax({type:"POST",url:"/user",dataType:"json",data:JSON.stringify(oReq),success:function(b){removeLoading($("#btnQ"));$("#boxQuestion").hide();if(b.xeach==false){showFail(b.message);
}else{showOk("成功提交,<a class='bluelink' href='/message'>点击此处</a>查看最新回复.");}}});};this.focusAuth=function(c){if(c==undefined||c.length==0){return;}var e=$("div[tag='"+c+"']");if(e==null||e.length==0){return;}var d=e.attr("data-status");var b=$("dl[tag='"+c+"']");if(d!="yes"){b.addClass("focus");e.show();
$("html,body").scrollTop(e.offset().top-130);}else{$("html,body").scrollTop(b.offset().top-130);}};this.selectAuth=function(b){if(pageName=="auth"){this.focusAuth(b);}else{window.location="/auth/name="+b;}};};$.Crop=function(){var a=this;this.preview=null;this.pcnt=null;this.pimg=null;this.xsize=0;this.ysize=0;
this.dataObject={};this.instance=null;this.pictureId=null;this.faceHtml=function(){return"<img id='imageFace' style='display:none'/><div id='preview-pane'><div class='preview-container'><img id='imageFace-preview' class='jcrop-preview' alt='Preview' /></div></div>";};this.init=function(b,c){a.dataObject.funcIndex=8;
a.preview=$("#preview-pane");var d=$("#preview-pane .preview-container");a.pimg=$("#preview-pane .preview-container img");a.pw=d.width();a.ph=d.height();$(b).Jcrop({onChange:a.onCropChange,onSelect:a.onCropChange,boxWidth:400,aspectRatio:a.pw/a.ph},function(){var e=this.getBounds();a.dataObject.bw=e[0];
a.dataObject.bh=e[1];a.instance=this;a.preview.remove();a.preview.appendTo(a.instance.ui.holder);a.dataObject.picture=c;this.setSelect([0,0,300,300]);});};this.onCropChange=function(k){if(a.instance){var d=a.instance.tellSelect();a.dataObject.x=d.x;a.dataObject.y=d.y;a.dataObject.w=d.w;a.dataObject.h=d.h;
}if(parseInt(k.w)>0){var i=a.pw/k.w;var g=a.ph/k.h;var e=Math.round(i*a.dataObject.bw);var f=Math.round(g*a.dataObject.bh);var b=Math.round(i*k.x);var j=Math.round(g*k.y);a.pimg.css({width:e+"px",height:f+"px",marginLeft:"-"+b+"px",marginTop:"-"+j+"px"});}};this.commit=function(b){showProcess(b);$.ajax({type:"POST",url:"/user",dataType:"json",data:JSON.stringify(a.dataObject),success:function(c){hideProcess(b);
if(c.xeach==false){showFail(c.message);}else{$("#cropFace").hide();showOk("剪切成功");}}});};};$.Activity=function(b){var a=this;this.lblCurrency="￥";this.calendar=null;this.prices=null;this.priceIndex=-1;this.dataObject=null;this.isBackend=b;this.maxStepIndex=0;this.profile=null;this.defaultPriceNames=[{value:"标准价"},{value:"不带车"},{value:"5座车"},{value:"7座车"},{value:"9座车"},{value:"10座车"},{value:"30座车"},{value:"50座车"}];
this.ActivityPriceNames=[{value:"全年"},{value:"旺季"},{value:"淡季"}];this.AgeNames=[{value:"成人 (≥18)岁 "},{value:"儿童 (5-17)岁"},{value:"婴儿 (0-4)岁"}];this.init=function(){if(this.isBackend==true){a.initLogicals();a.initProfile();}};this.initProfile=function(){var d=$("#profileContent");if(d.length==0){return;
}var c=d.text();if(c.length==0){return;}this.profile=JSON.parse(c);};this.initWizard=function(d){var c=$("#form-wizard li");c.click(function(){var i=$(this);var f=i.attr("data-target");var g=parseInt(f.replace(/#step/g,""));var h=$("#container").attr("shortId");if(h.length!=0||g<=a.maxStepIndex){a.focusStep(g);
}});if(d.price==undefined||d.price==0){return;}a.maxStepIndex=4;};this.prevStep=function(d){var c=parseInt($(d).attr("data-target"));a.focusStep(c-1);};this.nextStep=function(c){switch(a.dataObject.bizType){case 6:if(a.dataObject.catalog==0){a.nextStepByGuide(c);}break;case 5:a.nextStepByCar(c);break;
case 10:a.nextStepByReq(c);break;}};this.focusStep=function(e){a.maxStepIndex=Math.max(a.maxStepIndex,e);$("ul[class='steps'] li").removeClass("active");var c=$("ul[class='steps'] li[data-target='#step"+e+"']");c.addClass("active");var d=c.attr("data-target");$("div[class='step-content']").hide();$(d).show();
if(c.data("opened")!=true){a.initStep(e);}c.data("opened",true);};this.initStep=function(c){switch(c){case 4:break;}};this.checkStep=function(e,c){var d=$("li[data-target='#step"+e+"'] span");d.attr("class",c);};this.nextStepByGuide=function(d){var c=parseInt($(d).attr("data-target"));switch(c){case 1:if(checkLogicals(["#edtEthnicity","#edtCity","#edtJob","#edtBirthday","#edtWorkYear","#edtName","#edtMobile","#edtQQ","#edtMSN"])==false){a.checkStep(c,"fail");
return;}break;case 2:if(checkLogicals(["#edtTitle","#edtDesc"])==false){a.checkStep(c,"fail");return;}break;case 3:if($("#pictures li").length==0){showTip("#pictures","请至少设定一个图片");a.checkStep(c,"fail");return;}break;}a.checkStep(c,"success");a.focusStep(c+1);};this.nextStepByReq=function(d){var c=parseInt($(d).attr("data-target"));
switch(c){case 1:if(checkLogicals(["#edtDeptDate","#edtDay","#edtPerson","#edtBaby","#edtChild","#edtOld","#edtCarModel","#edtCarCount"])==false){a.checkStep(c,"fail");return;}break;}a.checkStep(c,"success");a.focusStep(c+1);};this.nextStepByCar=function(d){var c=parseInt($(d).attr("data-target"));switch(c){case 1:if(checkLogicals(["#edtEthnicity","#edtCity","#edtJob","#edtBirthday","#edtWorkYear","#edtName","#edtMobile","#edtQQ","#edtMSN"])==false){a.checkStep(c,"fail");
return;}break;case 2:if(checkLogicals(["#edtTitle","#edtDesc"])==false){a.checkStep(c,"fail");return;}break;case 3:if($("#pictures li").length==0){showTip("#pictures","请至少设定一个图片");a.checkStep(c,"fail");return;}break;}a.checkStep(c,"success");a.focusStep(c+1);};this.currentPrice=function(){if(this.priceIndex<0||this.priceIndex>=this.prices.length){return null;
}return this.prices[this.priceIndex];};this.initCalendar=function(f,e,c,d){a.calendar=$("#calendar").calendar({"bizType":f,"bizName":e,"shortId":c,"currency":d,"autoLoad":false,"change":function(i,j){if(i!="reload"){return;}var g=j.xeach;delete j["xeach"];var h=a.currentPrice();if(h==null){return;}if(g==true){h.calendar=j;
}else{a.calendar.setData(h.calendar);}a.showCalendar(h);}}).data("calendar");a.calendar.bindCurrency("#edtCurrency");};this.read=function(e,m,n){a.dataObject=m;switch(e){case"city":$("#edtCity").val(m.city);$("#edtCity").attr("country",m.country);break;case"car":$("#edtBrand").val(m.car_brand);if(m.car_model){$("#edtModel").val(m.car_model);
}else{$("#edtModel").val("");}break;case"product":$("#edtBrand").val(m.brand);$("#edtCountry").val(m.country);$("#edtDesigner").val(m.designer);$("#edtDesignerSay").val(m.designer_say);$("#edtDesignerFace").val(m.designer_face);$("#edtDesignerUrl").val(m.designer_url);selectValue("edtPostTime",m.post_time);
selectValue("edtCurrency",m.currency);selectValue("edtChargeWay",m.chargeWay);$("#edtPriceValue").val(m.price);$("#edtModel").val(m.model);$("#edtColor").val(m.color);$("#edtPost").val(m.post);$("#edtSource").val(m.source);break;case"desc":$("#edtTitle").val(m.title);if(m.base64==true){m.description=Base64.decode(m.description);
}$("#edtDesc").val(m.description);initRichEditor("#edtDesc",true);break;case"contact":$("#edtMobile").val(m.contact_mobile);$("#edtQQ").val(m.contact_qq);$("#edtMSN").val(m.contact_msn);$("#edtName").val(m.contact_person);break;case"payment":selectValue("edtCurrency",m.currency);selectValue("edtChargeWay",m.chargeWay);
$("#edtPriceValue").val(m.price);if((m.bizType==6&&m.catalog==0)||(m.bizType==5)){selectValue("edtMaxMile",m.maxmile);$("#edtTrans").val(m.trans);$("#edtTip").val(m.tip);$("#edtMeal").val(m.meal);$("#edtPerdiem").val(m.perdiem);$("#edtOvertime").val(m.overtime);}switch(m.bizType){case 10:$("span[class='currency'] em").text(getCurrencyName(m.currency));
break;default:this.prices=m.prices;a.renderPrices();a.initCalendar(m.bizType,m.bizName,m.shortId,m.currency);$("span[class='currency'] em").text(getCurrencyName(m.currency));$("#edtSecurityDeposit").val(m.securityDeposit);selectValue("edtPolicyCancel",m.policyCancel);break;}break;case"aboutme":if(!m){return;
}var l=JSON.parse(m);selectValue("edtEducation",l.education);if(l.ethnicity){$("#edtEthnicity").val(l.ethnicity);}if(l.job){$("#edtJob").val(l.job);}if(l.birthday){$("#edtBirthday").val(l.birthday);}else{if(a.profile){$("#edtBirthday").val(a.profile.birthdayString);}}if(l.workYear){$("#edtWorkYear").val(l.workYear);
}selectValue("edtIdType",l.idType);selectValue("edtSex",l.sex);break;case"langTags":case"tags":case"expertTags":case"bizTags":case"priceTags":var o=m[e];if(o){var j=new Hashtable();var q=JSON.parse(o);for(var h=0;h<q.length;h++){j.add(q[h],"true");}var c=$("input[tag='"+n+"']");for(var h=0;h<c.length;
h++){var g=c[h];g.checked=false;if(j.containsKey($(g).attr("value"))){g.checked=true;}}}break;case"locations":if(m.locations){var k=JSON.parse(m.locations);for(var h=0;k&&h<k.length;h++){tokenInputBy("#edtTargets").add(k[h]);}}break;case"photos":if(m.photos){var p=JSON.parse(m.photos);var f=dlgPicture.clearPictures();
for(var h=0;p&&h<p.length;h++){var d=p[h];d.visible=false;f.push(d);}dlgPicture.renderPictures(f);}break;case"room":$("#edtLodgeType option[value='"+m.lodge_type+"']").attr("selected",true);$("#edtLeaseType option[value='"+m.lease_type+"']").attr("selected",true);$("#edtToiletType option[value='"+m.toilet_type+"']").attr("selected",true);
selectValue("edtMaxDay",m.maxDay);selectValue("edtMinDay",m.minDay);selectValue("edtCheckin",m.checkIn);selectValue("edtCheckout",m.checkOut);break;case"req":if(m.dept_date){$("#edtDeptDate").val(longToDateStr(m.dept_date));}else{$("#edtDeptDate").val((new Date()).pattern("yyyy-MM-dd"));}$("#edtDay").val(m.day);
selectValue("edtHotel",m.hotel);$("#edtPerson").val(m.person);$("#edtBaby").val(m.baby);$("#edtChild").val(m.child);$("#edtOld").val(m.old);selectValue("edtSex",m.sex);selectValue("edtCarEnabled",m.car_enabled);$("#edtCarModel").val(m.car_model);$("#edtCarCount").val(m.car_count);break;}a.bizName=m.bizName;
};this.initLogicals=function(){addLogical("#edtDeptDate","请输入出发日期");addLogical("#edtEthnicity","请输入您是哪里人");addLogical("#edtCity","请输入您目前居住的城市");addLogical("#edtJob","请输入您目前的职业");addLogical("#edtBirthday","请输入您的出生年月日");addLogical("#edtWorkYear","请输入您工作的时间");addLogical("#edtBrand","请输入汽车品牌");addLogical("#edtModel","请输入汽车品牌对应的型号");
addLogical("#edtPersonCount","请输入人数");addLogical("#edtDay","请输入天数");addLogical("#edtCarModel","请输入车的品牌或型号");addLogical("#edtCarCount","请输入车辆数量");addLogical("#edtTargets","请输入哪些城市");addLogical("#edtTitle","请输入标题");addLogical("#edtDesc","请输入描述");addLogical("#edtSpecialPrice","请设定特定价格,且都必须是数字");addLogical("#edtName","请输入联系人姓名");
addLogical("#edtMobile","请输入手机号码");addLogical("#edtQQ","请输入qq号码");addLogical("#edtMSN","请输入微信号");addLogical("#edtBrand","请选择或输入汽车品牌");addLogical("#edtPerson","请输入总人数");addLogical("#edtBaby","请输入婴儿数量,没有请输入0");addLogical("#edtChild","请输入小孩数量,没有请输入0");addLogical("#edtOld","请输入老人数量,没有请输入0");addLogical("#address","您输入的地标,在GOOGLE无法定位!<br>请修改您的输入");
addLogical("#edtRangeStart","请选择开始日期");addLogical("#edtRangeStop","请选择结束日期");addLogical("#edtTrans","请输入返程计费");addLogical("#edtTip","请输入小费");addLogical("#edtMeal","请输入餐补");addLogical("#edtPerdiem","请输入住宿补助");addLogical("#edtOvertime","请输入超时补助");addLogical("#edtVenue","请输入集合地点");addLogical("#edtHour","请输入小时数");
};this.chargeWayChange=function(d,e){if(d=="room"){var c=parseInt($(e).val());switch(c){case 0:$("#priceName").text("每小时");$("#edtWeekPrice").attr("disabled",true);$("#edtMonthPrice").attr("disabled",true);break;case 6:$("#priceName").text("每天");$("#edtWeekPrice").attr("disabled",false);$("#edtMonthPrice").attr("disabled",false);
break;}}};this.fillReqAbout=function(c){c.education=$("#edtEducation").val();c.ethnicity=$("#edtEthnicity").val();c.job=$("#edtJob").val();c.birthday=$("#edtBirthday").val();c.workYear=$("#edtWorkYear").val();c.idType=$("#edtIdType").val();c.sex=$("#edtSex").val();};this.fillReqCommon=function(c,j){var e=$("#container").attr("shortId");
if(e.length!=0){j.shortId=parseFloat(e);}j.contactPerson=$("#edtName").val();j.contactMobile=$("#edtMobile").val();j.contactQQ=$("#edtQQ").val();j.contactMSN=$("#edtMSN").val();j.city="";j.country="";switch(c){case"req":j.deptDate=$("#edtDeptDate").val().toTime();j.day=$("#edtDay").val().toInt();j.hotel=$("#edtHotel").val().toInt();
j.person=$("#edtPerson").val().toInt();j.baby=$("#edtBaby").val().toInt();j.child=$("#edtChild").val().toInt();j.old=$("#edtOld").val().toInt();j.sex=$("#edtSex").val();j.carEnabled=$("#edtCarEnabled").val().toInt();j.carModel=$("#edtCarModel").val();j.carCount=$("#edtCarCount").val().toInt();j.title=$("#edtTitle").val();
break;case"guide":j.city=$("#edtCity").val();j.country=$("#edtCity").attr("country");j.title=$("#edtTitle").val();j.policyCancel=parseInt($("#edtPolicyCancel").val());j.securityDeposit=parseInt($("#edtSecurityDeposit").val());j.currency=parseInt($("#edtCurrency").val());j.chargeWay=parseInt($("#edtChargeWay").val());
j.maxmile=parseInt($("#edtMaxMile").val());j.trans=parseInt($("#edtTrans").val());j.tip=parseInt($("#edtTip").val());j.meal=parseInt($("#edtMeal").val());j.perdiem=parseInt($("#edtPerdiem").val());j.overtime=parseInt($("#edtOvertime").val());break;case"activity":j.title=$("#edtTitle").val();j.policyCancel=parseInt($("#edtPolicyCancel").val());
j.securityDeposit=parseInt($("#edtSecurityDeposit").val());j.currency=parseInt($("#edtCurrency").val());j.chargeWay=parseInt($("#edtChargeWay").val());j.hour=parseInt($("#edtHour").val());j.venue=parseInt($("#edtVenue").val());break;case"car":j.city=$("#edtCity").val();j.country=$("#edtCity").attr("country");
j.personCount=parseInt($("#edtPersonCount").val());j.carCount=parseInt($("#edtCarCount").val());j.carBrand=$("#edtBrand").val();j.carLogo="green";j.carModel=$("#edtModel").val();j.title=$("#edtTitle").val();j.policyCancel=parseInt($("#edtPolicyCancel").val());j.securityDeposit=parseInt($("#edtSecurityDeposit").val());
j.currency=parseInt($("#edtCurrency").val());j.chargeWay=parseInt($("#edtChargeWay").val());j.maxmile=parseInt($("#edtMaxMile").val());j.trans=parseInt($("#edtTrans").val());j.tip=parseInt($("#edtTip").val());j.meal=parseInt($("#edtMeal").val());j.perdiem=parseInt($("#edtPerdiem").val());j.overtime=parseInt($("#edtOvertime").val());
break;case"room":j.city=$("#edtCity").val();j.country=$("#edtCity").attr("country");j.lodgeType=$("#edtLodgeType").val();j.leaseType=$("#edtLeaseType").val();j.toiletType=$("#edtToiletType").val();j.minDay=$("#edtMinDay").val();j.maxDay=$("#edtMaxDay").val();j.checkIn=$("#edtCheckin").val();j.checkOut=$("#edtCheckout").val();
break;case"product":j.city=$("#edtCity").val();j.country=$("#edtCity").attr("country");j.country=$("#edtCountry").val();j.brand=$("#edtBrand").val();j.designer=$("#edtDesigner").val();j.designerSay=$("#edtDesignerSay").val();j.designerFace=$("#edtDesignerFace").val();j.designerUrl=$("#edtDesignerUrl").val();
j.post=$("#edtPost").val().toInt();j.postTime=$("#edtPostTime").val().toInt();j.source=$("#edtSource").val();j.model=$("#edtModel").val();j.color=$("#edtColor").val();break;}if(richEditorBy("#edtDesc")){j.description=richEditorBy("#edtDesc").getContent();}j.prices=this.prices;j.photos=[];j.snapshot="";
var o=$("#pictures img");for(var f=0;f<o.length;f++){var d=$(o[f]);var l={};l.oss=d.attr("oss");l.picture=d.attr("picture");l.title=d.attr("title");j.photos.push(l);if(f==0){j.snapshot=l.picture;}}var q=new Array("langTag","tag","expertTag","bizTag","priceTag");for(var f=0;f<q.length;f++){var g=q[f];
var k=g+"s";j[k]=[];var p=$("input[tag='"+g+"']");for(var n=0;n<p.length;n++){if(p[n].checked){j[k].push($(p[n]).val());}}}if(tokenInputs.containsKey("#edtTargets")){j.locations=[];var h=tokenInputBy("#edtTargets").getTokens();var m;for(var f=0;f<h.length;f++){m=h[f];if((!j.city||j.city.length==0)&&m.name){j.city=m.name;
}if((!j.country||j.country.length==0)&&m.country){j.country=m.country;}j.locations.push(m);}}};this.updatePriceBy=function(f,d){var e=a.prices[a.priceIndex];var c=$("dl[index='"+a.priceIndex+"']");switch(f){case"value":c.find("dd[class='PriceValue'] input").val(d);e.value=d;e.calendar=a.calendar.data();
a.calendar.updatePrice(d);break;case"person":c.find("dd[class='PricePerson'] input").val(d);e.person=d;break;}};this.updateRangePrice=function(e){if(checkLogicals(["#edtRangeStart","#edtRangeStop","#edtSpecialPrice"])==false){return false;}var d=$("#edtRangeStart").val().toDate();var c=$("#edtRangeStop").val().toDate();
var f=$("#edtBookState").val().toInt();a.calendar.updateRangePrice(d,c,e,f);var g=a.prices[a.priceIndex];g.calendar=a.calendar.data();};this.handlePriceKeyup=function(h){var j=$(h);var g=$(findParentByTag(h,"dl"));var c=$(findParentByTag(h,"dd"));var i=c.attr("class");var f=parseInt(g.attr("index"));
if(f!=a.priceIndex){a.hideCalendar();}var k=a.prices[f];if(k.calendar){a.calendar.setData(k.calendar);}switch(i){case"PriceName":k.name=j.val();break;case"PriceAge":k.age=j.val();break;case"PriceValue":case"PricePerson":checkNumberInput(h);var d=j.val();$("#edt"+i).val(d);i=i.replace("Price","").toLowerCase();
var d=parseInt(j.val());k[i]=d;if(k.calendar&&i=="value"){a.calendar.updatePrice(d);k.calendar=a.calendar.data();}break;}};this.handlePriceMenu=function(i){var j=$(i);var c=j.attr("tag");var h=$(findParentByTag(i,"dl"));var g=parseInt(h.attr("index"));var f=h.find("dd[class='PriceName'] input").val();
switch(c){case"edit":a.priceIndex=g;a.calendar.setOption("bizName",f);var d=a.prices[g];if(isEmptyObject(d.calendar)){a.calendar.readCalendar();}else{a.calendar.setData(d.calendar);a.showCalendar(d);}break;case"delete":if(!confirm("确定要删除["+f+"]吗？")){return;}this.prices.splice(g,1);this.renderPrices();
break;}};this.checkPrices=function(){if(a.prices.length==0){showTip("#addPrice","您必须设定一个价格方案");return false;}var f=0;var e=new Hashtable();for(var d=0;d<a.prices.length;d++){var c=a.prices[d];if(c.name.length==0){showTip("dl[index='"+d+"'] dd[class='PriceName'] input","您必须设定一个价格方案");return false;}if(c.value==0){showTip("dl[index='"+d+"'] dd[class='PriceValue'] input","您必须设定一个价格");
return false;}if(c.person==0){showTip("dl[index='"+d+"'] dd[class='PricePerson'] input","您必须设定人数");return false;}if(e.containsKey(c.name)){showTip("dl[index='"+d+"'] dd[class='PriceName'] input","价格方案名不能重复");return false;}e.add(c.name,c.name);if(c.active){f++;}}if(f==0){showTip("#addPrice","必须至少有一个价格方案处于【运营状态】");
return false;}return true;};this.addPrice=function(){var c={};c.name="";c.value=0;c.person=0;c.active=true;c.calendar={};this.prices.push(c);this.renderPrices();};this.renderPrice=function(d,f){var c=$(d);c.find(".PriceName input").val(f.name);c.find(".PriceValue input").val(f.value);c.find(".PricePerson input").val(f.person);
if(f.active){c.find(".PriceActive div").attr("class","price-switch on");}else{c.find(".PriceActive div").attr("class","price-switch");}};this.hideCalendar=function(){if(a.priceIndex==-1){return;}var c=$("#editRow").parent();if(c.attr("id")=="hidden"){return;}moveNode("editRow","hidden");$("#edtPriceValue,#edtPricePerson,#edtSpecialPrice").unbind("keyup");
$("#edtBookState").unbind("change");a.priceIndex=-1;};this.showCalendar=function(c){$("#edtPriceValue").val(c.value);$("#edtPricePerson").val(c.person);moveNode("editRow","edit"+a.priceIndex);$("#edtPriceValue,#edtPricePerson").keyup(function(){var d=$(this);checkNumberInput(this);var f=$(this).attr("id");
f=f.replace("edtPrice","").toLowerCase();a.updatePriceBy(f,parseInt(d.val()));});$("#edtSpecialPrice").keyup(function(){var d=$(this);checkNumberInput(this);a.updateRangePrice(parseInt(d.val()));}).val("0");$("#edtBookState").change(function(){var d=parseInt($("#edtSpecialPrice").val());a.updateRangePrice(d);
});if(pageName=="postguide"||pageName=="postcar"){$("#edtRangeStart").dateinput({direction:1,pair:$("#edtRangeStop")}).val("");$("#edtRangeStop").dateinput({direction:1}).val("");}a.calendar.bindCurrency("#edtCurrency");};this.renderPrices=function(){$("#prices input").unbind("keyup");$(".PriceActive div").unbind("click");
$(".PriceMenu a").unbind("click");a.hideCalendar();var d=new JsEvalContext(this.prices);var c=document.getElementById("prices");var e=jstGetTemplate("templateRow");c.innerHTML="";c.appendChild(e);jstProcess(d,c);$("#prices input").keyup(function(){a.handlePriceKeyup(this);});$(".PriceActive div").click(function(){var h=$(this);
var g=$(h.parent().parent());var f=parseInt(g.attr("index"));var i=a.prices[f];if(h.hasClass("on")){h.attr("class","price-switch");i.active=false;}else{h.attr("class","price-switch on");i.active=true;}});$(".PriceMenu a").click(function(){a.handlePriceMenu(this);});a.initPriceNameInputs();};this.initPriceNameInputs=function(){var c=a.defaultPriceNames;
if(pageName=="postactivity"){c=a.ActivityPriceNames;}$("dd[class='PriceAge'] input").autocomplete({title:"输入或选择年龄段",data:a.AgeNames,sortResults:false,showResult:function(e,d){return"<span>"+e+"</span>";},displayValue:function(e,d){return d.value;},mustMatch:false,selectFirst:true,selectOnly:false,onItemSelect:function(e,d){a.handlePriceKeyup(d.dom.$elem[0]);
}});$("dd[class='PriceName'] input").autocomplete({title:"输入或选择报价方案名称",data:c,sortResults:false,showResult:function(e,d){return"<span>"+e+"</span>";},displayValue:function(e,d){return d.value;},mustMatch:false,selectFirst:true,selectOnly:false,onItemSelect:function(e,d){a.handlePriceKeyup(d.dom.$elem[0]);
}});};this.init();};$.DialogPicture=function(c,d,b){var a=this;this.onSelect=c;this.dests=[];if(d){this.readDests=d;}if(b){this.onChange=b;}this.box=null;this.dlgPictureScrollbar=null;this.selectedPictures=[];this.pictureUploader=null;this.options={};this.options.groupIndex=0;this.getDests=function(){if(this.readDests){return this.readDests.apply(this,[this.options.groupIndex]);
}return this.dests;};this.settings=function(){return a.options;};this.pictures=function(){return this.dests;};this.clearPictures=function(){this.dests.splice(0,this.dests.length);return this.dests;};this.popup=function(){this.box.popup();};this.setOption=function(e,f){this.options[e]=f;};this.refreshJoin=function(e){$("div[class='join']").css("display","none");
for(var f=0;f<e.length;f++){var g=e[f];var h=$("div[class='join'][picture='"+g.picture+"']");if(h){h.css("display","block");}}};this.init=function(){$("#editPicture").click(function(){a.editPicture();});$("#removePicture").click(function(){a.removePicture();});$("#dlgPicTag").change(function(){a.searchPicture(1,8);
});a.box=$("#dlgpicture").dialog({background:"white",centerOnResize:true,fade:true,width:790,height:430,zIndex:999,title:"上传图片或从照片集中选择",buttons:["取消","确定"],onInit:function(){$("#dlgpicture").attr("display","block");a.initUploadPic("#fileupload");},onClick:function(e){if(e=="确定"){a.onSelect(a.selectedPictures);
}},onShow:function(){$("#dlgpicture span[class='checked']").attr("class","uncheck");a.selectedPictures=a.getDests().concat();a.refreshJoin(a.selectedPictures);a.updatePicScrollbar();a.pictureUploader.clearQueue();}}).data("dialog");};this.updatePicScrollbar=function(){if(a.dlgPictureScrollbar!=null){a.dlgPictureScrollbar.tinyscrollbar_update("bottom");
return;}var e=$('#dlgpicture div[class="scroller"]');if(e.length==0){return;}a.dlgPictureScrollbar=$('#dlgpicture div[class="scroller"]').tinyscrollbar({size:100});};this.initUploadPic=function(f){var e=$("#dlgpicture").attr("token");a.pictureUploader=$('#dlgpicture div[class="fileHolder"]').ajaxupload({url:"http://p.yiqihi.com",allowExt:["jpg","jpeg","png"],controlHolder:"#uploaderControl",dropArea:$('#dlgpicture div[class="fileHolder"]'),language:"chinese",autoStart:true,dropColor:"#EEE",error:function(j){var g=[];
for(var h=0;h<j.length;h++){g.push("<p>"+"文件："+j[h].name+"</p>");g.push("<p>"+j[h].message+"</p>");g.push("<hr/>");}showFail(g.join(""));},success:function(g){var h={};h.picture=g.picture;h.oss=g.oss;h.title=g.title;a.selectedPictures.push(h);},beforeUpload:function(g,h){a.updatePicScrollbar();return true;
},afterClear:function(){a.updatePicScrollbar();}}).data("AU");$("#dlgpicture .menu a[link='uploader']").addClass("selected");$("#dlgpicture .menu a").click(function(){var g=$(this);$("#dlgpicture .menu a").removeClass("selected");g.addClass("selected");var h=g.attr("link");$("#dlgpicture .tab div[tag]").hide();
$("#dlgpicture .tab div[tag='"+h+"']").show();if(h=="files"){a.searchPicture(1,8);}});};this.searchPicture=function(f,e){var g={};g.pageNumber=f;g.pageSize=e;g.q=$("#dlgPicTag").val();showLoading("#dlgPicLoading");$.ajax({type:"POST",url:"/searchPicture",dataType:"json",async:false,data:JSON.stringify(g),success:function(h){hideLoading("#dlgPicLoading");
if(h.xeach==false){showFail(h.message);return false;}var k=[];updateSelectElement("#dlgPicTag",h.tags);for(var j=0;j<h.items.length;j++){var l=h.items[j];k.push("<li>");k.push('<div style="height:100px;">');k.push('<img src="'+shotUrl(l.picture)+'"');k.push(' picture="'+l.picture+'"/>');k.push('<div class="join" style="display:none" picture="'+l.picture+'">已加入</div>');
k.push("</div>");k.push('<div class="op icons">');k.push('<span picture="'+l.picture+'" title="'+l.name+'" oss="'+l.oss+'" class="uncheck" ><em></em><font>'+l.name+"</font></span><br>"+'<span class="tag"></span><label class="tag">'+l.tag+"</label>");k.push("</div>");k.push("</li>");}$("#dlgpicture .items li img").unbind("click");
$("#dlgpicture .items li span[picture]").unbind("click");$("#dlgpicture .items ul").html(k.join(""));$("#dlgpicture .items li img").bind("click",function(i){return a.clickPicture(i.currentTarget);});$("#dlgpicture .items li span[picture]").bind("click",function(i){return a.selectPicture(i.currentTarget);
});a.refreshJoin(a.selectedPictures);renderPage("#dlgpicture .pagebar",h.totalCount,f,e,a.searchPicture);}});};this.addToSelect=function(g){var h={};h.title=g.attr("title");h.oss=g.attr("oss");h.picture=g.attr("picture");for(var f=0;f<a.selectedPictures.length;f++){if(a.selectedPictures[f].picture==h.picture){return;
}}a.selectedPictures.push(h);};this.removeFromSelect=function(f){for(var e=0;e<a.selectedPictures.length;e++){if(a.selectedPictures[e].picture==f){a.selectedPictures.splice(e,1);return;}}};this.selectPicture=function(g){var f=$(g);if(f.attr("class")=="uncheck"){f.attr("class","checked");a.addToSelect(f);
}else{f.attr("class","uncheck");a.removeFromSelect(f.attr("picture"));}};this.clickPicture=function(g){var f=$(g);var f=$("#dlgpicture span[picture='"+f.attr("picture")+"']");a.selectPicture(f);};this.removePicture=function(){var f=$("#dlgpicture span[class='checked']");if(f.length==0){showFail("请勾选要删除的图片.");
return;}if(confirm("确定要删除吗?")==false){return;}var k={};k.pictures=[];for(var g=0;g<f.length;g++){var j=$(f[g]);var h={};h.picture=j.attr("picture");k.pictures.push(h);}k.funcIndex=0;showLoading("#dlgPicLoading");$.ajax({type:"POST",url:"/editPicture",dataType:"json",async:false,data:JSON.stringify(k),success:function(e){hideLoading("#dlgPicLoading");
for(var l=0;l<e.items.length;l++){var m=e.items[l];a.removeFromSelect(m);}a.searchPicture(1,8);}});};this.editPicture=function(){var g=$("#dlgpicture span[class='checked']");if(g.length==0){showFail("请勾选要修改的图片.");return;}var l={};l.pictures=[];for(var h=0;h<g.length;h++){var k=$(g[h]);var j={};j.picture=k.attr("picture");
l.pictures.push(j);}l.tag=valueBy("#edtPicTag");if(l.tag.length==0){showFail("必须输入标签.");return;}var f=this;l.funcIndex=1;showLoading("#dlgPicLoading");$.ajax({type:"POST",url:"/editPicture",dataType:"json",async:false,data:JSON.stringify(l),success:function(e){hideLoading("#dlgPicLoading");if(e.xeach==false){showFail(e.message);
return false;}$("#dlgpicture span[class='checked']").parent().find("label[class='tag']").text(l.tag);updateSelectElement("#dlgPicTag",e.tags);$("#dlgpicture span[class='checked']").attr("class","uncheck");}});};this.mergePictures=function(e,k){var g=new Hashtable();for(var f=0;f<k.length;f++){var l=k[f];
g.add(l.picture,l);}for(var f=0;f<e.length;f++){var j=e[f];var h=j.picture;if(g.containsKey(h)){continue;}k.push(j);}};this.setInsertCallback=function(e){this.options["insertCallback"]=e;};this.renderPictures=function(n){var m=[];var g="#pictures";if(this.options.id){g=this.options.id;}var k=this.options["insertCallback"];
var j=g.replace("#","");for(var h=0;h<n.length;h++){var f=n[h];m.push('<li><div class="i">');m.push('<img id="'+j+"_"+h+'"/>');var o=' parentId="'+j+'" group="'+this.options.groupIndex+'" picture="'+f.picture+'" ';if(k){m.push('<span  class="insert"'+o+">插入图片</span>");}else{m.push('<div class="b">');
m.push("<span>"+f.title+"</span>");m.push("</div>");}m.push('<a class="delete" '+o+"></a>");m.push("</div>");m.push("</li>");}$(g+" a[class='delete']").unbind("click");$(g+" span[class='insert']").unbind("click");$(g).dragsort("destroy");$(g).html(m.join(""));for(var h=0;h<n.length;h++){var f=n[h];var l=$(g+"_"+h);
l.attr("src",shotUrl(f.picture));l.attr("picture",f.picture);l.attr("group",this.options.groupIndex);l.attr("parentId",j);l.attr("title",f.title);l.attr("oss",f.oss);}$(g+" a[class='delete']").click(function(e){a.removePictureBy(this);});if(k){$(g+" span[class='insert']").click(function(i){var p=$(this);
k.apply(this,[p.attr("parentId"),p.attr("group"),p.attr("picture")]);});}$(g).dragsort({dragSelector:"div",dragBetween:true,placeHolderTemplate:"<li class='dragPictureHolder'><div></div></li>",dragEnd:function(p,r){var u=$(this).find("img");var t=u.attr("group");if(t.isNumber()){a.options.groupIndex=parseInt(t);
}else{a.options.groupIndex=t;}var i=parseInt(p.split("-")[1]);var q=parseInt(r.split("-")[1]);var s=a.getDests();var v=s[i];s[i]=s[q];s[q]=v;if(a.onChange){a.onChange(s);}}});};this.removePictureBy=function(l){var k=$(l);var h=k.attr("picture");var g=k.attr("group");if(g.isNumber()){this.options.groupIndex=parseInt(g);
}else{this.options.groupIndex=g;}var j=this.getDests();for(var f=0;f<j.length;f++){var m=j[f];if(m.picture==undefined||m.picture==h){j.splice(f,1);break;}}if(this.onChange){this.onChange(j);}var n=k.attr("parentId");if(n){this.options.id="#"+n;}a.renderPictures(j);};this.init();};userPortal=new $.UserPortal();


$.WebTalk=function(){this.ws=null;this.isOpen=false;this.msgInfos=new Hashtable();this.topicInfos=new Hashtable();this.lastMsgId=null;this.lastMessage=null;this.dlgJoinUser=null;var a=this;$.ionSound({sounds:["msg"]});this.initWebSocket=function(b,c){if(a.ws!=null&&a.isOpen){$.msg("unblock",0,1);return;
}$.msg({content:"正在与服务器建立连接...",autoUnblock:false,msgID:1});a.ws=new WebSocket(currentWebSocketUri);a.ws.onopen=function(){a.isOpen=true;var d={};d.action="auth";d.code=b?"reconnect":"connect";d.cookieId=$("#header").attr("cookieId");d.userId=$("#header").attr("userId");d.userName=$("#header").attr("userName");
a.ws.send(JSON.stringify(d));if(c!=null){c();}};a.ws.onmessage=function(f){var d=JSON.parse(f.data);if((d.action=="auth")){$.msg("unblock",0,1);if(a.lastMsgId!=null&&a.lastMessage!=null){a.sendMessage(a.lastMsgId,a.lastMessage);}}else{if((d.action=="enter")){a.renderMessages(d.msgId,d.messages);}else{if(d.action=="say"||d.action=="picture"||d.action=="voice"){a.addMessage(d);
a.lastMsgId=null;a.lastMessage=null;}else{if(d.action=="readMessages"){a.renderMessages(d.msgId,d);}}}}};a.ws.onclose=function(d){a.isOpen=false;};a.ws.onerror=function(d){};};this.setUnReadMsg=function(d,b){var c=$(d);if(b.unReadMsg==0){c.hide();}else{c.show();c.text(b.unReadMsg);}};this.sendMessage=function(c,b){if(a.isOpen==false){a.lastMsgId=c;
a.lastMessage=b;a.initWebSocket(true);return;}var d={};d.action="say";d.msgId=c;d.content=b;d.sendtime=(new Date()).valueOf();d.cookieId=$("#header").attr("cookieId");a.msgInfos.add(c+"@"+d.sendtime,d);a.ws.send(JSON.stringify(d));};this.setFaceImage=function(c,b){if(parseInt(b.userId)<=200){$(c).attr("src","/images/customerService.png").attr("width","36").attr("height","29");
}else{$(c).attr("src",faceUrl(b.userId)).attr("width","40").attr("height","40");}};this.addContact=function(c){var b=[];b.push("<div class='clearfix user_box'>");if(parseInt(c.userId)<=200){b.push("<img width='36' height='29' src='/images/customerService.png' class='user_pic_box fl'>");}else{b.push("<img width='40' height='40' src='"+faceUrl(c.userId)+"' class='user_pic_box fl'>");
}b.push("<span class='msg_user_name fl'>");b.push(c.userName);b.push("</span> <span class='fr'></span>");b.push("</div>");$("#contact_"+c.msgId).append(b.join(""));};this.enter=function(b){var c={};c.action="enter";c.code="connect";c.cookieId=$("#header").attr("cookieId");c.msgId=b;c.readMessages=false;
a.ws.send(JSON.stringify(c));};this.addMessage=function(g){var e=a.msgInfos.remove(g.msgId+"@"+g.sendtime);var d=a.topicInfos.get(g.msgId);if(d==undefined){return;}var c=[];var h,l;if(g.from){h=g.from.userId;l=g.from.userName;}else{h=g.userId;l=g.userName;}if(d.userId!=h){if(d.lastClassName="msg_item_l"){d.lastClassName="msg_item_r";
}else{d.lastClassName="msg_item_l";}}d.lastUserId=h;var j=e==null?g.content:e.content;c.push("<div class='msg_item_box "+d.lastClassName+" clearfix'>");c.push("<div class='msg_item_pic'>");c.push("<a class='dialist_pic_box' target='_blank' href='/i/"+h+"'>"+l+"</a>");c.push("</div>");c.push("<div class='msg_item_content'>");
c.push("<div class='msg_arrow'>");c.push("<em class='line2_c'>◆</em> <span class='bg5_c'>◆</span>");c.push("</div>");c.push("<div class='msg_item_main'>");c.push("<div class='msg_dia_con'>");c.push("<p class='msg_dia_txt'>");if(g.msgType==1){var m=JSON.parse(j);for(var f=0;f<m.length;f++){var o=m[f];
var b=shotUrl(o.picture);c.push("<a target='_blank' href='"+b+"'><img width='100px' height='100px' src='"+b+"'></a>");}}else{if(g.msgType==2){var o=JSON.parse(j);var k="javascript:void(0)";c.push("<a target='_blank' href='"+k+"'>语音</a>");}else{c.push(j.replace(/\r/g,"<br>"));}}c.push("</p>");c.push("<div class='msg_time'>");
if(g.ago){c.push("<span class='a'>"+g.ago+"</span>");c.push("<span class='h'>"+g.timestamp+"</span>");}else{var n=g.sendtime;if(n==undefined){n=g.timestamp;}c.push("<span class='a'>"+dateDiff(n)+"</span>");c.push("<span class='h'>"+longToDateTimeStr(n)+"</span>");}c.push("</div>");c.push("</div>");c.push("</div>");
c.push("</div>");c.push("</div>");$("#msg_"+g.msgId).append(c.join(""));d.scroll.tinyscrollbar_update("bottom");};this.openDialog=function(d){var g=$("#"+d);var f=$("#talk_"+d);var c=f.attr("state");if(c=="1"){return;}var e=a.topicInfos.get(d);if(e!=null&&e.loading==true){return;}var b=$("#"+d+" em[class='icon_pre_num']");
b.text("0");b.hide();g.addClass("current");f.attr("state","1");f.addClass("i_msg_form");$("#"+d+" a[class='icon_aw_b_down']").attr("class","icon_aw_b_up");if(parseInt(f.attr("pageNumber"))==1){a.readTopic(d);}else{f.show();e.scroll.tinyscrollbar_update("bottom");}};this.closeDialog=function(c){var e=$("#"+c);
var d=$("#talk_"+c);var b=d.attr("state");if(b=="0"){return;}d.removeClass("i_msg_form");e.removeClass("current");$("#"+c+" a[class='icon_aw_b_up']").attr("class","icon_aw_b_down");d.attr("state","0");d.hide();};this.readTopic=function(e){var h=$("#talk_"+e);var c=parseInt(h.attr("pageNumber"));var d=parseInt(h.attr("pageCount"));
if(d!=0&&c>d){return;}var g={};g.funcIndex=1;g.pageNumber=c;g.pageSize=pageSize;g.msgId=e;g.readContact=c==1;var f=a.topicInfos.get(e);if(f==undefined){f={};f.lastClassName="msg_item_l";a.topicInfos.add(e,f);}f.loading=true;var b=$("#"+e+" h5");showProcess(b);$.ajax({type:"POST",url:"/talk",dataType:"json",data:JSON.stringify(g),success:function(k){f.loading=false;
hideProcess(b);if(k.xeach==true){a.renderMessages(e,k);}var j=parseInt(h.attr("pageCount"));if(c==1){j=getPageCount(pageSize,k.totalCount);h.attr("pageCount",j);a.initTopicInfo(e,k,f);a.renderContact(e,k);}var i=$("#talk_"+e+" a[class='loadmore']");if(c<j){i.show();}else{i.hide();}h.attr("pageNumber",c+1);
h.show();f.scroll.tinyscrollbar_update("top");if(c==1){a.enter(e);}return false;}});};this.renderMessages=function(g,d){var h=$("#msg_"+g);var e=$("<div jsselect='$this.items'></div>");e.prependTo(h);var c=new JsEvalContext(d);var b=e[0];c.setVariable("$index",0);var f=jstGetTemplate("templateMsg");b.appendChild(f);
jstProcess(c,b);};this.renderContact=function(f,d){var c=new JsEvalContext(d);var b=document.getElementById("contact_"+f);var e=jstGetTemplate("templateContact");b.appendChild(e);jstProcess(c,b);};this.initTopicInfo=function(h,g,i){var d=$("#talk_"+h+" a[class='loadmore']");d.unbind("click").bind("click",function(j){a.readTopic(h);
j.stopPropagation();});var c=$("#talk_"+h+" a[class='user_close']");c.unbind("click").bind("click",function(j){a.closeDialog(h);j.stopPropagation();});var e=$("#talk_"+h+" a[class='user_join']");e.unbind("click").bind("click",function(k){var j=$(this);a.dlgJoinUser.config().msgId=j.attr("msgId");a.dlgJoinUser.popup();
k.stopPropagation();});var b=$("#talk_"+h+" div[class='scroller']");i.scroll=b.tinyscrollbar({size:100});var f=$("textarea[msgId='"+h+"']");f.watermark({top:9,onEnter:function(){var j=f.val();f.val("");f.focus();if(j.length==0){return;}a.sendMessage(h,j);}});};this.initJoinUserDialog=function(){a.dlgJoinUser=$("#dlgJoinUser").dialog({background:"#FFFFFF",centerOnResize:true,fade:true,width:500,height:40,zIndex:999,title:"邀请好友加入",buttons:["增加"],onInit:function(){},onClick:function(b){if(b=="增加"){var c=$("#edtJoinUserName").val();
if(c.length==0){return;}var d={};d.userName=c;d.funcIndex=2;d.msgId=a.dlgJoinUser.config().msgId;$.ajax({type:"POST",url:"/talk",dataType:"json",data:JSON.stringify(d),success:function(e){if(e.xeach==false){$("#loadJoinUser").text(e.message);return;}a.dlgJoinUser.close();a.addContact(e);}});}},onShow:function(){}}).data("dialog");
};this.readMessageByDay=function(b,d){var c=$(d);var f={};f.funcIndex=3;f.day=b;f.pageNumber=parseInt(c.attr("pageNumber"))+1;showLoading(d);$.ajax({type:"POST",url:"/talk",dataType:"json",data:JSON.stringify(f),success:function(g){hideLoading(d);c.attr("pageNumber",f.pageNumber);if(g.xeach==true){a.renderDayList(g);
}var e=getPageCount(10,g.totalCount);if(f.pageNumber>=e){$("#btnLoadMore").hide();}}});};this.renderDayList=function(e){var b=$("#dayMore");var f=$("<div jsselect='$this.items'></div>");f.prependTo(b);var d=new JsEvalContext(e);var c=f[0];var g=jstGetTemplate("templateDay");c.appendChild(g);jstProcess(d,c);
a.bindClick();};this.bindClick=function(){var b=$("div[tag='msgHeader']");b.unbind("click");b.bind("click",function(d){d.stopPropagation();var c=$(this).attr("id");if(a.ws==null||a.isOpen==false){a.initWebSocket(false,function(){a.handleClick(c);});return;}a.handleClick(c);});};this.handleClick=function(d){var b=$("#talk_"+d);
var c=b.attr("state");if(c=="1"){a.closeDialog(d);}else{a.openDialog(d);}};};

var VAR_index="$index";var VAR_count="$count";var VAR_this="$this";var VAR_context="$context";var VAR_top="$top";var GLOB_default="$default";var CHAR_colon=":";var REGEXP_semicolon=/\s*;\s*/;function JsEvalContext(a,b){this.constructor_.apply(this,arguments);}JsEvalContext.prototype.constructor_=function(a,b){var c=this;
if(!c.vars_){c.vars_={};}if(b){copyProperties(c.vars_,b.vars_);}else{copyProperties(c.vars_,JsEvalContext.globals_);}c.vars_[VAR_this]=a;c.vars_[VAR_context]=c;c.data_=getDefaultObject(a,STRING_empty);if(!b){c.vars_[VAR_top]=c.data_;}c.vars_[VAR_index]=0;c.vars_[VAR_count]=0;};JsEvalContext.globals_={};
JsEvalContext.setGlobal=function(a,b){JsEvalContext.globals_[a]=b;};JsEvalContext.prototype.setGlobalArgs=function(b,c){var a=JsEvalContext.globals_["$args"];a[b]=c;};JsEvalContext.setGlobal(GLOB_default,null);JsEvalContext.setGlobal("$args",{"index":0,"childIndex":0});JsEvalContext.recycledInstances_=[];
JsEvalContext.create=function(b,c){if(jsLength(JsEvalContext.recycledInstances_)>0){var a=JsEvalContext.recycledInstances_.pop();JsEvalContext.call(a,b,c);return a;}else{return new JsEvalContext(b,c);}};JsEvalContext.recycle=function(a){for(var b in a.vars_){delete a.vars_[b];}a.data_=null;JsEvalContext.recycledInstances_.push(a);
};JsEvalContext.prototype.jsexec=function(b,a){try{return b.call(a,this.vars_,this.data_);}catch(c){log("jsexec EXCEPTION: "+c+" at "+a+" with "+b);return JsEvalContext.globals_[GLOB_default];}};JsEvalContext.prototype.clone=function(d,b,c){var a=JsEvalContext.create(d,this);a.setVariable(VAR_index,b);
a.setVariable(VAR_count,c);return a;};JsEvalContext.prototype.setVariable=function(a,b){this.vars_[a]=b;};JsEvalContext.prototype.getVariable=function(a){return this.vars_[a];};JsEvalContext.prototype.evalExpression=function(c,b){var a=jsEvalToFunction(c);return this.jsexec(a,b);};var STRING_a="a_";var STRING_b="b_";
var STRING_with="with (a_) with (b_) return ";JsEvalContext.evalToFunctionCache_={};function jsEvalToFunction(b){if(!JsEvalContext.evalToFunctionCache_[b]){try{JsEvalContext.evalToFunctionCache_[b]=new Function(STRING_a,STRING_b,STRING_with+b);}catch(a){log("jsEvalToFunction ("+b+") EXCEPTION "+a);}}return JsEvalContext.evalToFunctionCache_[b];
}function jsEvalToSelf(a){return a;}function jsEvalToValues(h){var d=[];var a=h.split(REGEXP_semicolon);for(var e=0,c=jsLength(a);e<c;++e){var f=a[e].indexOf(CHAR_colon);if(f<0){continue;}var b=stringTrim(a[e].substr(0,f));var g=jsEvalToFunction(a[e].substr(f+1));d.push(b,g);}return d;}function jsEvalToExpressions(f){var c=[];
var a=f.split(REGEXP_semicolon);for(var d=0,b=jsLength(a);d<b;++d){if(a[d]){var e=jsEvalToFunction(a[d]);c.push(e);}}return c;}var ATT_select="jsselect";var ATT_instance="jsinstance";var ATT_display="jsdisplay";var ATT_values="jsvalues";var ATT_vars="jsvars";var ATT_eval="jseval";var ATT_transclude="transclude";
var ATT_content="jscontent";var ATT_html="jshtml";var ATT_call="jscall";var ATT_skip="jsskip";var ATT_jstcache="jstcache";var PROP_jstcache="__jstcache";var STRING_jsts="jsts";var CHAR_asterisk="*";var CHAR_dollar="$";var CHAR_period=".";var CHAR_ampersand="&";var STRING_div="div";var STRING_id="id";
var STRING_asteriskzero="*0";var STRING_zero="0";function jstProcess(a,d,c){var b=new JstProcessor;if(MAPS_DEBUG&&c){b.setDebugging(c);}JstProcessor.prepareTemplate_(d);b.document_=ownerDocument(d);b.run_(bindFully(b,b.jstProcessOuter_,a,d));if(MAPS_DEBUG&&c){log("jstProcess:"+"\n"+b.getLogs().join("\n"));
}}function JstProcessor(){if(MAPS_DEBUG){this.logs_=[];}}JstProcessor.jstid_=0;JstProcessor.jstcache_={};JstProcessor.jstcache_[0]={};JstProcessor.jstcacheattributes_={};JstProcessor.attributeValues_={};JstProcessor.attributeList_=[];JstProcessor.prepareTemplate_=function(a){if(!a[PROP_jstcache]){domTraverseElements(a,function(b){JstProcessor.prepareNode_(b);
});}};var JST_ATTRIBUTES=[[ATT_select,jsEvalToFunction],[ATT_display,jsEvalToFunction],[ATT_values,jsEvalToValues],[ATT_vars,jsEvalToValues],[ATT_eval,jsEvalToExpressions],[ATT_transclude,jsEvalToSelf],[ATT_content,jsEvalToFunction],[ATT_html,jsEvalToFunction],[ATT_call,jsEvalToFunction],[ATT_skip,jsEvalToFunction]];
JstProcessor.prepareNode_=function(e){if(e[PROP_jstcache]){return e[PROP_jstcache];}var c=domGetAttribute(e,ATT_jstcache);if(c!=null){return e[PROP_jstcache]=JstProcessor.jstcache_[c];}var m=JstProcessor.attributeValues_;var d=JstProcessor.attributeList_;d.length=0;for(var g=0,l=jsLength(JST_ATTRIBUTES);
g<l;++g){var b=JST_ATTRIBUTES[g][0];var k=domGetAttribute(e,b);m[b]=k;if(k!=null){d.push(b+"="+k);}}if(d.length==0){domSetAttribute(e,ATT_jstcache,STRING_zero);return e[PROP_jstcache]=JstProcessor.jstcache_[0];}var j=d.join(CHAR_ampersand);if(c=JstProcessor.jstcacheattributes_[j]){domSetAttribute(e,ATT_jstcache,c);
return e[PROP_jstcache]=JstProcessor.jstcache_[c];}var a={};for(var g=0,l=jsLength(JST_ATTRIBUTES);g<l;++g){var h=JST_ATTRIBUTES[g];var b=h[0];var f=h[1];var k=m[b];if(k!=null){a[b]=f(k);if(MAPS_DEBUG){a.jstAttributeValues=a.jstAttributeValues||{};a.jstAttributeValues[b]=k;}}}c=STRING_empty+ ++JstProcessor.jstid_;
domSetAttribute(e,ATT_jstcache,c);JstProcessor.jstcache_[c]=a;JstProcessor.jstcacheattributes_[j]=c;return e[PROP_jstcache]=a;};JstProcessor.prototype.run_=function(g){var i=this;var l=i.calls_=[];var k=i.queueIndices_=[];var e=i.arrayPool_=[];g();var d,h;var a,c,b;var j;while(l.length){d=l[l.length-1];
h=k[k.length-1];if(h>=d.length){i.recycleArray_(l.pop());k.pop();continue;}a=d[h++];c=d[h++];b=d[h++];k[k.length-1]=h;a.call(i,c,b);}};JstProcessor.prototype.push_=function(a){this.calls_.push(a);this.queueIndices_.push(0);};JstProcessor.prototype.setDebugging=function(a){if(MAPS_DEBUG){this.debugging_=a;
}};JstProcessor.prototype.createArray_=function(){if(this.arrayPool_.length){return this.arrayPool_.pop();}else{return[];}};JstProcessor.prototype.recycleArray_=function(a){arrayClear(a);this.arrayPool_.push(a);};JstProcessor.prototype.jstProcessOuter_=function(c,e){var f=this;var h=f.jstAttributes_(e);
if(MAPS_DEBUG&&f.debugging_){f.logState_("Outer",e,h.jstAttributeValues);}var b=h[ATT_transclude];if(b){var g=jstGetTemplate(b);if(g){domReplaceChild(g,e);var d=f.createArray_();d.push(f.jstProcessOuter_,c,g);f.push_(d);}else{domRemoveNode(e);}return;}var a=h[ATT_select];if(a){f.jstSelect_(c,e,a);}else{f.jstProcessInner_(c,e);
}};JstProcessor.prototype.jstProcessInner_=function(b,q){var n=this;var g=n.jstAttributes_(q);if(MAPS_DEBUG&&n.debugging_){n.logState_("Inner",q,g.jstAttributeValues);}var r=g[ATT_vars];if(r){n.jstVars_(b,q,r);}r=g[ATT_values];if(r){n.jstValues_(b,q,r);}var h=g[ATT_eval];if(h){for(var e=0,o=jsLength(h);
e<o;++e){b.jsexec(h[e],q);}}var k=g[ATT_display];if(k){var a=b.jsexec(k,q);if(MAPS_DEBUG&&n.debugging_){n.logs_.push(ATT_display+": "+a+"<br/>");}if(!a){displayNone(q);return;}displayDefault(q);}var p=g[ATT_skip];if(p){var d=b.jsexec(p,q);if(MAPS_DEBUG&&n.debugging_){n.logs_.push(ATT_skip+": "+d+"<br/>");
}if(d){return;}}var m=g[ATT_html];if(m){n.jstHtml_(b,q,m);return;}var j=g[ATT_content];if(j){n.jstContent_(b,q,j);}else{var f=n.createArray_();for(var l=q.firstChild;l;l=l.nextSibling){if(l.nodeType==DOM_ELEMENT_NODE){f.push(n.jstProcessOuter_,b,l);}}if(f.length){n.push_(f);}}};JstProcessor.prototype.jstSelect_=function(a,p,l){var k=this;
var n=a.jsexec(l,p);var q=domGetAttribute(p,ATT_instance);var h=false;if(q){if(q.charAt(0)==CHAR_asterisk){q=parseInt10(q.substr(1));h=true;}else{q=parseInt10((q));}}var r=isArray(n);var g=r?jsLength(n):1;var c=(r&&g==0);if(r){if(c){if(!q){domSetAttribute(p,ATT_instance,STRING_asteriskzero);displayNone(p);
}else{domRemoveNode(p);}}else{displayDefault(p);if(q===null||q===STRING_empty||(h&&q<g-1)){var e=k.createArray_();var f=q||0;var d,m,j;for(d=f,m=g-1;d<m;++d){var b=domCloneNode(p);domInsertBefore(b,p);jstSetInstance((b),n,d);j=a.clone(n[d],d,g);e.push(k.jstProcessInner_,j,b,JsEvalContext.recycle,j,null);
}jstSetInstance(p,n,d);j=a.clone(n[d],d,g);e.push(k.jstProcessInner_,j,p,JsEvalContext.recycle,j,null);k.push_(e);}else{if(q<g){var o=n[q];jstSetInstance(p,n,q);var j=a.clone(o,q,g);var e=k.createArray_();e.push(k.jstProcessInner_,j,p,JsEvalContext.recycle,j,null);k.push_(e);}else{domRemoveNode(p);}}}}else{if(n==null){displayNone(p);
}else{displayDefault(p);var j=a.clone(n,0,1);var e=k.createArray_();e.push(k.jstProcessInner_,j,p,JsEvalContext.recycle,j,null);k.push_(e);}}};JstProcessor.prototype.jstVars_=function(e,f,a){for(var d=0,c=jsLength(a);d<c;d+=2){var b=a[d];var g=e.jsexec(a[d+1],f);e.setVariable(b,g);}};JstProcessor.prototype.jstValues_=function(b,n,o){for(var d=0,l=jsLength(o);
d<l;d+=2){var h=o[d];var k=b.jsexec(o[d+1],n);if(h.charAt(0)==CHAR_dollar){b.setVariable(h,k);}else{if(h.charAt(0)==CHAR_period){var m=h.substr(1).split(CHAR_period);var f=n;var e=jsLength(m);for(var c=0,g=e-1;c<g;++c){var a=m[c];if(!f[a]){f[a]={};}f=f[a];}f[m[e-1]]=k;}else{if(h){if(typeof k==TYPE_boolean){if(k){domSetAttribute(n,h,h);
}else{domRemoveAttribute(n,h);}}else{domSetAttribute(n,h,STRING_empty+k);}}}}}};JstProcessor.prototype.jstContent_=function(b,c,d){var e=STRING_empty+b.jsexec(d,c);if(c.innerHTML==e){return;}while(c.firstChild){domRemoveNode(c.firstChild);}var a=domCreateTextNode(this.document_,e);domAppendChild(c,a);
};JstProcessor.prototype.jstHtml_=function(a,b,c){var d=STRING_empty+a.jsexec(c,b);if(b.innerHTML==d){return;}while(b.firstChild){domRemoveNode(b.firstChild);}b.innerHTML=d;};JstProcessor.prototype.jstAttributes_=function(b){if(b[PROP_jstcache]){return b[PROP_jstcache];}var a=domGetAttribute(b,ATT_jstcache);
if(a){return b[PROP_jstcache]=JstProcessor.jstcache_[a];}return JstProcessor.prepareNode_(b);};function jstGetTemplate(b,e){var d=document;var c;if(e){c=jstLoadTemplateIfNotPresent(d,b,e);}else{c=domGetElementById(d,b);}if(c){JstProcessor.prepareTemplate_(c);var a=domCloneElement(c);domRemoveAttribute(a,STRING_id);
return a;}else{return null;}}function jstGetTemplateOrDie(b,c){var a=jstGetTemplate(b,c);check(a!==null);return(a);}function jstLoadTemplateIfNotPresent(d,a,e,b){var c=domGetElementById(d,a);if(c){return c;}jstLoadTemplate_(d,e(),b||STRING_jsts);var c=domGetElementById(d,a);if(!c){log("Error: jstGetTemplate was provided with opt_loadHtmlFn, "+"but that function did not provide the id '"+a+"'.");
}return(c);}function jstLoadTemplate_(d,b,a){var e=domGetElementById(d,a);var c;if(!e){c=domCreateElement(d,STRING_div);c.id=a;displayNone(c);positionAbsolute(c);domAppendChild(d.body,c);}else{c=e;}var f=domCreateElement(d,STRING_div);c.appendChild(f);f.innerHTML=b;}function jstSetInstance(c,a,b){if(b==jsLength(a)-1){domSetAttribute(c,ATT_instance,CHAR_asterisk+b);
}else{domSetAttribute(c,ATT_instance,STRING_empty+b);}}JstProcessor.prototype.logState_=function(a,b,c){if(MAPS_DEBUG){var d="<table>";d+="<caption>"+a+"</caption>";d+="<tbody>";if(b.id){d+="<tr><td>"+"id:"+"</td><td>"+b.id+"</td></tr>";}if(b.name){d+="<tr><td>"+"name:"+"</td><td>"+b.name+"</td></tr>";
}if(c){d+="<tr><td>"+"attr:"+"</td><td>"+jsToSource(c)+"</td></tr>";}d+="</tbody></table><br/>";this.logs_.push(d);}};JstProcessor.prototype.getLogs=function(){return this.logs_;};

